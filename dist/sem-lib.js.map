{"version":3,"sources":["webpack:///webpack/universalModuleDefinition","webpack:///webpack/bootstrap 0151243f991f81369ee7","webpack:///./lib/SortedSet/RedBlackTreeNode.js","webpack:///./lib/isNumeric.js","webpack:///./lib/toInteger.js","webpack:///./lib/Inwaiting.js","webpack:///./lib/sem-lib.js","webpack:///./lib/Semaphore.js","webpack:///(webpack)/buildin/global.js","webpack:///./lib/SortedSet/AbstractSortedSet.js","webpack:///./lib/SortedSet/RedBlackTreeStrategy.js","webpack:///./lib/SortedSet/AbstractBinaryTreeStrategy.js","webpack:///./lib/SortedSet/BinaryTreeIterator.js","webpack:///./lib/SortedSet/BinaryTreeNode.js","webpack:///./lib/iterator.js"],"names":["BinaryTreeNode","require","module","exports","value","parent","isRed","isNumeric","obj","undefined","Array","isArray","parsed","parseFloat","toInteger","num","positive","_default","Number","POSITIVE_INFINITY","NEGATIVE_INFINITY","parseInt","RedBlackTreeNode","hasProp","Object","hasOwnProperty","globalCounter","Inwaiting","semID","task","priority","options","id","taken","semaphore","forEach","prop","call","nextNum","onCancel","_removeItem","_setImmediate","semGive","nextPriority","group","stack","remove","length","_queue","_insertItem","keys","destroyed","Semaphore","assign","semCreate","args","AbstractSortedSet","RedBlackTreeStrategy","createIterator","isObject","idComparator","a","b","priorityComparator","onlyOnce","fn","Error","callFn","apply","arguments","SortedSet","comparator","priv","node","root","cmp","left","right","capacity","isFull","sync","strategy","_capacity","_numTokens","prototype","getNumTokens","getCapacity","setCapacity","overflow","_semTake","semFlush","item","handleTimeout","onTimeOut","semTake","result","hasOptions","timeOut","onTake","Function","addCounter","bind","cancel","setPriority","timer","setTimeout","_shouldTakeToken","shouldTakeToken","_hasMissingToken","hasMissingToken","_nextGroupItem","groupIterator","itemIterator","beginIterator","Math","min","next","topSync","_taking","keepAlive","_keepAlive","_checkKeepAlive","_destroyWaiting","weakerIterator","weakeGroup","weakerItemIterator","weakerItem","unfair","endIterator","previous","_runTask","hasNext","timerID","_clearImmediate","destroy","safe","onDestroy","_destroying","__onDestroy","_destroy","i","_len","j","_jlen","schedule","collection","iteratee","callback","iterator","cancellers","errors","items","waiting","canceled","done","loops","hasError","nextItem","push","replenish","scheduled","give","err","error","key","icancel","abort","code","_item","Proxy","get","target","receiver","Reflect","_insertGroup","insert","_hasInWaitingTask","clearTimeout","isAlive","Boolean","hasInWaitingTask","_countInWaitingTokens","count","_this","allowNode","global","setImmediate","clearImmediate","g","eval","e","window","contains","toArray","thisArg","forEachImpl","ret","index","self","findIterator","AbstractBinaryTreeStrategy","rotateLeft","tmp","rotateRight","colorFlip","moveRedLeft","moveRedRight","insertInNode","compare","findMinNode","fixUp","removeMinNode","removeFromNode","BinaryTreeIterator","binaryTreeTraverse","some","pos","allowSetValue","sortedSet","find","descendAllTheWay","leftOrRight","moveCursor","rightOrLeft","tree","nextNode","createArrayIterator","arr","len","createObjectIterator","createIterableIterator","iterable","Symbol"],"mappings":"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","file":"sem-lib.js","sourcesContent":["(function webpackUniversalModuleDefinition(root, factory) {\n\tif(typeof exports === 'object' && typeof module === 'object')\n\t\tmodule.exports = factory();\n\telse if(typeof define === 'function' && define.amd)\n\t\tdefine([], factory);\n\telse if(typeof exports === 'object')\n\t\texports[\"semLib\"] = factory();\n\telse\n\t\troot[\"semLib\"] = factory();\n})(typeof self !== 'undefined' ? self : this, function() {\nreturn \n\n\n// WEBPACK FOOTER //\n// webpack/universalModuleDefinition"," \t// The module cache\n \tvar installedModules = {};\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId]) {\n \t\t\treturn installedModules[moduleId].exports;\n \t\t}\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\ti: moduleId,\n \t\t\tl: false,\n \t\t\texports: {}\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.l = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// define getter function for harmony exports\n \t__webpack_require__.d = function(exports, name, getter) {\n \t\tif(!__webpack_require__.o(exports, name)) {\n \t\t\tObject.defineProperty(exports, name, {\n \t\t\t\tconfigurable: false,\n \t\t\t\tenumerable: true,\n \t\t\t\tget: getter\n \t\t\t});\n \t\t}\n \t};\n\n \t// getDefaultExport function for compatibility with non-harmony modules\n \t__webpack_require__.n = function(module) {\n \t\tvar getter = module && module.__esModule ?\n \t\t\tfunction getDefault() { return module['default']; } :\n \t\t\tfunction getModuleExports() { return module; };\n \t\t__webpack_require__.d(getter, 'a', getter);\n \t\treturn getter;\n \t};\n\n \t// Object.prototype.hasOwnProperty.call\n \t__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"\";\n\n \t// Load entry module and return exports\n \treturn __webpack_require__(__webpack_require__.s = 4);\n\n\n\n// WEBPACK FOOTER //\n// webpack/bootstrap 0151243f991f81369ee7","const BinaryTreeNode = require(\"./BinaryTreeNode\");\r\n\r\n// Here are some differences:\r\n// * This isn't a map structure: it's just a tree. There are no keys: the\r\n//   comparator applies to the values.\r\n// * We use the passed comparator.\r\nmodule.exports = class RedBlackTreeNode extends BinaryTreeNode {\r\n    constructor(value, parent = null) {\r\n        super(value, parent);\r\n        this.isRed = true; // null nodes -- leaves -- are black\r\n    }\r\n};\r\n\n\n\n// WEBPACK FOOTER //\n// ./lib/SortedSet/RedBlackTreeNode.js","const isNumeric = obj => {\r\n    if (obj === undefined || obj === null || Array.isArray(obj)) {\r\n        return false;\r\n    }\r\n\r\n    const parsed = parseFloat(obj);\r\n    if (obj === parsed) {\r\n        return true;\r\n    }\r\n\r\n    return obj - parsed + 1 >= 0;\r\n};\r\n\r\nmodule.exports = isNumeric;\r\n\n\n\n// WEBPACK FOOTER //\n// ./lib/isNumeric.js","const isNumeric = require(\"./isNumeric\");\r\n\r\n/**\r\n * Value of parsed interger or default value if not a number or < 0\r\n * @param  {Any} num value to parse\r\n * @param  {Interger} _default default value\r\n * @return {Interger} parsing result\r\n */\r\nconst toInteger = (num, positive, _default) => {\r\n    if (!isNumeric(num)) {\r\n        return _default;\r\n    }\r\n\r\n    if (num === Number.POSITIVE_INFINITY) {\r\n        return num;\r\n    }\r\n\r\n    if (num === Number.NEGATIVE_INFINITY) {\r\n        return positive ? _default : num;\r\n    }\r\n\r\n    num = parseInt(num, 10);\r\n\r\n    return positive && num < 0 ? _default : num;\r\n};\r\n\r\nmodule.exports = toInteger;\r\n\n\n\n// WEBPACK FOOTER //\n// ./lib/toInteger.js","const RedBlackTreeNode = require(\"./SortedSet/RedBlackTreeNode\");\r\nconst toInteger = require(\"./toInteger\");\r\n\r\nconst hasProp = Object.hasOwnProperty;\r\n\r\n// Debugging purpose\r\nlet globalCounter = 0;\r\n\r\nclass Inwaiting extends RedBlackTreeNode {\r\n    constructor(semID, task, priority, num, options) {\r\n        super();\r\n        this.value = this;\r\n        this.id = ++globalCounter;\r\n        this.taken = 0;\r\n        this.task = task;\r\n        this.priority = priority;\r\n        this.num = num;\r\n        this.semaphore = semID;\r\n\r\n        if (options) {\r\n            [\r\n                \"onTimeOut\",\r\n                \"onCancel\",\r\n                \"unfair\",\r\n                \"shouldTakeToken\",\r\n                \"hasMissingToken\",\r\n                \"sync\",\r\n                \"hasNext\"\r\n            ].forEach(prop => {\r\n                if (hasProp.call(options, prop)) {\r\n                    this[prop] = options[prop];\r\n                }\r\n            });\r\n        }\r\n    }\r\n\r\n    addCounter(nextNum) {\r\n        this.num += toInteger(nextNum, true, 1);\r\n    }\r\n\r\n    cancel() {\r\n        const {onCancel, taken, semaphore: semID} = this;\r\n        semID._removeItem(this);\r\n\r\n        if (taken !== 0) {\r\n            // give on next tick to wait for all synchronous canceled to be done\r\n            semID._setImmediate(() => {\r\n                semID.semGive(taken, true);\r\n            });\r\n        }\r\n\r\n        if (typeof onCancel === \"function\") {\r\n            onCancel();\r\n        }\r\n    }\r\n\r\n    setPriority(nextPriority) {\r\n        if (this.group == null) {\r\n            return;\r\n        }\r\n\r\n        const {semaphore: semID} = this;\r\n\r\n        nextPriority = toInteger(nextPriority, false, semID.priority);\r\n        if (nextPriority === this.priority) {\r\n            return;\r\n        }\r\n\r\n        this.group.stack.remove(this);\r\n        if (this.group.stack.length === 0) {\r\n            // No more inWaiting for this priority group\r\n            semID._queue.remove(this.group);\r\n        }\r\n\r\n        this.priority = nextPriority;\r\n        semID._insertItem(this);\r\n    }\r\n\r\n    destroy() {\r\n        // Remove properties to allow garbage collection\r\n        Object.keys(this).forEach(prop => {\r\n            switch(prop) {\r\n                case \"cancel\":\r\n                case \"id\":\r\n                case \"num\":\r\n                case \"scheduled\":\r\n                case \"taken\":\r\n                    break;\r\n                default:\r\n                    delete this[prop];\r\n            }\r\n        });\r\n\r\n        // Prevent usage of these methods on a destroyed object\r\n        [\"addCounter\", \"setPriority\", \"destroy\"].forEach(prop => {\r\n            this[prop] = undefined;\r\n        });\r\n\r\n        this.destroyed = true;\r\n    }\r\n}\r\n\r\nmodule.exports = Inwaiting;\r\n\n\n\n// WEBPACK FOOTER //\n// ./lib/Inwaiting.js","const Semaphore = require(\"./Semaphore\");\r\nconst Inwaiting = require(\"./Inwaiting\");\r\n\r\nObject.assign(exports, {\r\n    semCreate: (...args) => {\r\n        return new Semaphore(...args);\r\n    },\r\n    Semaphore,\r\n    Inwaiting\r\n});\r\n\n\n\n// WEBPACK FOOTER //\n// ./lib/sem-lib.js","const AbstractSortedSet = require(\"./SortedSet/AbstractSortedSet\");\r\nconst RedBlackTreeStrategy = require(\"./SortedSet/RedBlackTreeStrategy\");\r\nconst createIterator = require(\"./iterator\");\r\nconst isNumeric = require(\"./isNumeric\");\r\nconst toInteger = require(\"./toInteger\");\r\nconst Inwaiting = require(\"./Inwaiting\");\r\n\r\nconst isObject = obj => {\r\n    return typeof obj === \"object\" && obj !== null;\r\n};\r\n\r\nconst idComparator = (a, b) => {\r\n    return a.id > b.id ? 1 : a.id < b.id ? -1 : 0;\r\n};\r\n\r\nconst priorityComparator = (a, b) => {\r\n    return a.priority > b.priority ? 1 : a.priority < b.priority ? -1 : 0;\r\n};\r\n\r\nconst onlyOnce = fn => {\r\n    return function() {\r\n        if (fn === null) {\r\n            throw new Error(\"Callback was already called.\");\r\n        }\r\n\r\n        const callFn = fn;\r\n        fn = null;\r\n        callFn.apply(null, arguments);\r\n    };\r\n};\r\n\r\nconst {hasOwnProperty: hasProp} = Object;\r\n\r\n// Debugging purpose\r\nlet globalCounter = 0;\r\n\r\nclass SortedSet extends AbstractSortedSet {\r\n    get(value) {\r\n        const {comparator} = this.priv;\r\n        let {root: node} = this.priv;\r\n        let cmp;\r\n\r\n        while (node !== null) {\r\n            cmp = comparator(value, node.value);\r\n            if (cmp === 0) {\r\n                break;\r\n            } else if (cmp < 0) {\r\n                node = node.left;\r\n            } else {\r\n                node = node.right;\r\n            }\r\n        }\r\n\r\n        return node === null ? undefined : node.value;\r\n    }\r\n}\r\n\r\n/**\r\n * @param  {Integer} capacity (default = 1) Number of tokens that can be handled by the Semaphore\r\n * @param  {Boolean} isFull   (default = false) if true object is created with tokens\r\n * @param  {Integer} priority (default = 15) default priority\r\n * @param  {Boolean} sync     if true tasks will be run synchronously\r\n */\r\nfunction Semaphore(capacity, isFull, priority, sync = false) {\r\n    const _queue = new SortedSet({\r\n        comparator: priorityComparator,\r\n        strategy: RedBlackTreeStrategy\r\n    });\r\n\r\n    this.id = ++globalCounter;\r\n    this._capacity = toInteger(capacity, true, 1);\r\n    this._queue = _queue;\r\n    this._numTokens = isFull ? this._capacity : 0;\r\n    // eslint-disable-next-line no-magic-numbers\r\n    this.priority = toInteger(priority, false, 15);\r\n    this.sync = sync;\r\n}\r\n\r\n/**\r\n * Return the number of available tokens\r\n * @return {Interger} number of available tokens\r\n */\r\nSemaphore.prototype.getNumTokens = function getNumTokens() {\r\n    return this._numTokens;\r\n};\r\n\r\n/**\r\n * Return the maximum of available tokens\r\n * @return {Integer} maximum of available tokens\r\n */\r\nSemaphore.prototype.getCapacity = function getCapacity() {\r\n    return this._capacity;\r\n};\r\n\r\n/**\r\n * Set the maximum of available tokens\r\n * @return {Integer} maximum of available tokens\r\n */\r\nSemaphore.prototype.setCapacity = function setCapacity(capacity) {\r\n    this._capacity = toInteger(capacity, true, this._capacity);\r\n};\r\n\r\n/**\r\n * Add tokens to the Semaphore\r\n *\r\n * @param {Interger} num Number of tokens to add\r\n * @param {Boolean}  allow capacity overflow\r\n */\r\nSemaphore.prototype.semGive = function semGive(num, overflow) {\r\n    if (this.destroyed) {\r\n        return false;\r\n    }\r\n\r\n    if (num !== Number.POSITIVE_INFINITY) {\r\n        num = toInteger(num, true, 1);\r\n        if (num < 1) {\r\n            num = 1;\r\n        }\r\n        this._numTokens += num;\r\n    } else {\r\n        this._numTokens = num;\r\n    }\r\n\r\n    if (!overflow && this._numTokens > this._capacity) {\r\n        this._numTokens = this._capacity;\r\n    }\r\n\r\n    this._semTake(overflow);\r\n\r\n    if (overflow && this._numTokens > this._capacity) {\r\n        this._numTokens = this._capacity;\r\n    }\r\n\r\n    return true;\r\n};\r\n\r\n/**\r\n * Give tokens to every inwaiting tasks\r\n */\r\nSemaphore.prototype.semFlush = function semFlush() {\r\n    if (this.destroyed) {\r\n        return false;\r\n    }\r\n\r\n    this._numTokens = 0;\r\n    this._queue.forEach(group => {\r\n        group.stack.forEach(item => {\r\n            item.num = 0;\r\n        });\r\n    });\r\n    this._semTake();\r\n    return true;\r\n};\r\n\r\nSemaphore.prototype.handleTimeout = function handleTimeout(item) {\r\n    const {onTimeOut, taken} = item;\r\n    this._removeItem(item);\r\n\r\n    if (taken !== 0) {\r\n        // give on next tick to wait for all synchronous canceled to be done\r\n        this._setImmediate(() => {\r\n            this.semGive(taken, true);\r\n        });\r\n    }\r\n\r\n    if (typeof onTimeOut === \"function\") {\r\n        onTimeOut();\r\n    }\r\n};\r\n\r\n/**\r\n * Wait for Semaphore availability before calling onTake callback\r\n * @example\r\n * semTake(Function[, takeInstance]);\r\n * semTake(Settings[, takeInstance]);\r\n *\r\n * @param {Object} options options with the following properties:\r\n * <ul>\r\n * <li>{Function} <b><em>onTake</em></b></li>: called on successful take\r\n * <li>{Integer} <b><em>num</em></b></li>(optional, default = 1): Number of tokens to take before calling onTake callback\r\n * <li>{Integer} <b><em>priority</em></b></li>(optional): task priority, smaller is higher priority\r\n * <li>{Number} <b><em>timeOut</em></b></li>(optional): milliseconds to wait before timeOut. If !(options['timeOut'] > 0), waiting will last forever\r\n * <li>{Function} <b><em>onTimeOut</em></b></li>(optional): called if timeOut occurs\r\n * </ul>\r\n * @return {Object|false} item item.addCounter(n = 1) => wait for n more tokens\r\n */\r\nSemaphore.prototype.semTake = function semTake(options, result) {\r\n    if (this.destroyed) {\r\n        return false;\r\n    }\r\n\r\n    const hasOptions = isObject(options);\r\n    let task, timeOut, num, priority;\r\n\r\n    if (hasOptions) {\r\n        task = options.onTake;\r\n        priority = options.priority;\r\n        num = options.num;\r\n        timeOut = options.timeOut;\r\n    } else if (typeof options === \"function\") {\r\n        task = options;\r\n        options = null;\r\n    }\r\n\r\n    if (typeof task !== \"function\") {\r\n        task = Function.prototype;\r\n    }\r\n\r\n    num = toInteger(num, true, 1);\r\n    priority = toInteger(priority, false, this.priority);\r\n\r\n    const item = new Inwaiting(this, task, priority, num, hasOptions ? options : false);\r\n\r\n    if (typeof result === \"function\") {\r\n        result(item);\r\n    } else if (isObject(result)) {\r\n        result.addCounter = item.addCounter.bind(item);\r\n        result.cancel = item.cancel.bind(item);\r\n        result.setPriority = item.setPriority.bind(item);\r\n    }\r\n\r\n    this._insertItem(item);\r\n\r\n    if (isNumeric(timeOut) && timeOut > 0) {\r\n        item.timer = setTimeout(this.handleTimeout.bind(this, item), timeOut);\r\n    }\r\n\r\n    this._semTake();\r\n    return item;\r\n};\r\n\r\nSemaphore.prototype._shouldTakeToken = function _shouldTakeToken(item, num) {\r\n    // avoid giving item as context when calling shouldTakeToken\r\n    return typeof item.shouldTakeToken !== \"function\" || (0, item.shouldTakeToken)(num, item.num, item.taken, this);\r\n};\r\n\r\nSemaphore.prototype._hasMissingToken = function _hasMissingToken(item) {\r\n    if (typeof item.hasMissingToken === \"function\") {\r\n        // avoid giving item as context when calling hasMissingToken\r\n        (0, item.hasMissingToken)(this);\r\n    }\r\n};\r\n\r\nSemaphore.prototype._nextGroupItem = function _nextGroupItem() {\r\n    let groupIterator, group, itemIterator, item;\r\n\r\n    groupIterator = this._queue.beginIterator();\r\n    group = groupIterator.value();\r\n\r\n    itemIterator = group.stack.beginIterator();\r\n    item = itemIterator.value();\r\n\r\n    while (item && item.num !== 0 && !this._shouldTakeToken(item, Math.min(item.num, this._numTokens))) {\r\n        item = null;\r\n\r\n        itemIterator = itemIterator.next();\r\n\r\n        if (itemIterator === null) {\r\n            groupIterator = groupIterator.next();\r\n\r\n            if (groupIterator === null) {\r\n                group = null;\r\n                break;\r\n            }\r\n\r\n            itemIterator = group.stack.beginIterator();\r\n        }\r\n\r\n        item = itemIterator.value();\r\n    }\r\n\r\n    return [group, item];\r\n};\r\n\r\n/**\r\n * Take tokens if available\r\n *\r\n */\r\nSemaphore.prototype._semTake = function _semTake(topSync) {\r\n    if (this._taking) {\r\n        return;\r\n    }\r\n\r\n    if (typeof this.keepAlive === \"undefined\") {\r\n        this._keepAlive();\r\n    }\r\n\r\n    this._taking = true;\r\n    while (this._checkKeepAlive(this._destroyWaiting)) {\r\n        const [group, item] = this._nextGroupItem();\r\n        if (item == null) {\r\n            break;\r\n        }\r\n\r\n        let weakerIterator, weakeGroup, weakerItemIterator, weakerItem;\r\n\r\n        // if item is still waiting for tokens\r\n        if (item.num > this._numTokens) {\r\n            item.taken += this._numTokens;\r\n            item.num -= this._numTokens;\r\n            this._numTokens = 0;\r\n\r\n            // take token from tasks with weaker priority\r\n            if (item.unfair && this._queue.length !== 1) {\r\n                weakerIterator = this._queue.endIterator().previous();\r\n\r\n                while (weakerIterator && item.num !== 0) {\r\n                    weakeGroup = weakerIterator.value();\r\n                    if (weakeGroup === group || weakeGroup.priority <= this.priority) {\r\n                        // can only be unfair on tasks with lower priority that semaphore default priority\r\n                        break;\r\n                    }\r\n\r\n                    weakerItemIterator = weakeGroup.stack.endIterator().previous();\r\n                    weakerItem = weakerItemIterator ? weakerItemIterator.value() : null;\r\n\r\n                    while (weakerItem && item.num !== 0) {\r\n                        if (weakerItem.taken > 0 && this._shouldTakeToken(item, Math.min(item.num, weakerItem.taken))) {\r\n                            const taken = item.num > weakerItem.taken ? weakerItem.taken : item.num;\r\n                            item.taken += taken;\r\n                            item.num -= taken;\r\n                            weakerItem.num += taken;\r\n                            weakerItem.taken -= taken;\r\n                        }\r\n\r\n                        weakerItemIterator = weakerItemIterator.previous();\r\n                        weakerItem = weakerItemIterator ? weakerItemIterator.value() : null;\r\n                    }\r\n\r\n                    if (item.num === 0) {\r\n                        break;\r\n                    }\r\n\r\n                    weakerIterator = weakerIterator ? weakerIterator.previous() : null;\r\n                }\r\n            }\r\n\r\n            // if item is still waiting for tokens, try again at next give or flush\r\n            if (item.num !== 0) {\r\n                this._hasMissingToken(item);\r\n                break;\r\n            }\r\n        }\r\n\r\n        if (item.num !== 0) {\r\n            item.taken += item.num;\r\n            if (this._numTokens !== Number.POSITIVE_INFINITY) {\r\n                this._numTokens -= item.num;\r\n            }\r\n            item.num = 0;\r\n        }\r\n\r\n        this._runTask(item, topSync);\r\n    }\r\n    this._taking = false;\r\n};\r\n\r\nSemaphore.prototype._runTask = function(item, topSync) {\r\n    const sync = typeof topSync !== \"undefined\" ? topSync : typeof item.sync !== \"undefined\" ? item.sync : this.sync;\r\n    const {taken, task, onCancel, hasNext} = item;\r\n\r\n    if (sync) {\r\n        if (!hasNext || typeof hasNext !== \"function\" || !hasNext.call(item)) {\r\n            this._removeItem(item);\r\n\r\n            // Prevent usage of cancel\r\n            item.cancel = undefined;\r\n        }\r\n        task();\r\n        return;\r\n    }\r\n\r\n    // Non blocking call of callback\r\n    // A way to loop through in waiting tasks without blocking\r\n    // the semaphore process until done\r\n    let timerID = this._setImmediate(() => {\r\n        timerID = null;\r\n        task();\r\n    });\r\n\r\n    item.cancel = () => {\r\n        // Prevent usage of cancel\r\n        item.cancel = undefined;\r\n\r\n        this._clearImmediate(timerID);\r\n        timerID = null;\r\n\r\n        // give on next tick to wait for all synchronous canceled to be done\r\n        this._setImmediate(() => {\r\n            this.semGive(taken, true);\r\n        });\r\n\r\n        if (typeof onCancel === \"function\") {\r\n            onCancel();\r\n        }\r\n    };\r\n\r\n    // call hasNext after cancel is set to allow hasNext\r\n    if (!hasNext || typeof hasNext !== \"function\" || !hasNext.call(item)) {\r\n        this._removeItem(item);\r\n    }\r\n};\r\n\r\n/**\r\n * Destroy all inwaiting tasks\r\n * @param  {Boolean} safe if true, wait for all inwaiting tasks to be performed, else, destroy with no warn\r\n */\r\nSemaphore.prototype.destroy = function(safe, onDestroy) {\r\n    if (this._destroying) {\r\n        return false;\r\n    }\r\n\r\n    this._destroying = true;\r\n    this.__onDestroy = onDestroy;\r\n\r\n    if (safe !== false) {\r\n        this._destroyWaiting = true;\r\n        this._semTake();\r\n        return true;\r\n    }\r\n\r\n    return this._destroy(safe);\r\n};\r\n\r\nSemaphore.prototype._destroy = function(safe) {\r\n    this._destroyWaiting = false;\r\n\r\n    let i, _len, j, _jlen;\r\n\r\n    // for loop to avoid infinite loop with while\r\n    for (i = 0, _len = this._queue.length; i < _len; i++) {\r\n        const group = this._queue.beginIterator().value();\r\n\r\n        for (j = 0, _jlen = group.stack.length; j < _jlen; j++) {\r\n            const item = group.stack.beginIterator().value();\r\n            if (safe !== false) {\r\n                item.cancel();\r\n            }\r\n            this._removeItem(item);\r\n        }\r\n    }\r\n\r\n    if (this._checkKeepAlive()) {\r\n        return false;\r\n    }\r\n\r\n    const __onDestroy = this.__onDestroy;\r\n\r\n    this.destroyed = true;\r\n    if (\"function\" === typeof __onDestroy) {\r\n        __onDestroy();\r\n    }\r\n    return true;\r\n};\r\n\r\nSemaphore.prototype.schedule = function(collection, priority, iteratee, callback) {\r\n    switch (arguments.length) {\r\n        case 2:\r\n            if (typeof priority === \"function\") {\r\n                callback = priority;\r\n                priority = null;\r\n            }\r\n            break;\r\n        case 3:\r\n            callback = iteratee;\r\n            iteratee = null;\r\n\r\n            if (\"function\" === typeof priority) {\r\n                iteratee = priority;\r\n                priority = null;\r\n            }\r\n            break;\r\n        default:\r\n            // Nothing to do\r\n    }\r\n\r\n    if (callback == null) {\r\n        callback = Function.prototype;\r\n    }\r\n\r\n    const iterator = createIterator(collection);\r\n    if (iterator === null) {\r\n        callback();\r\n        return null;\r\n    }\r\n\r\n    callback = onlyOnce(callback);\r\n\r\n    const cancellers = [];\r\n    const errors = [];\r\n    const items = [];\r\n    let item;\r\n    let waiting = 0;\r\n    let canceled = false;\r\n    let done = false;\r\n    let loops = 0;\r\n    let hasError = false;\r\n\r\n    const hasNext = () => {\r\n        if (done) {\r\n            return false;\r\n        }\r\n\r\n        const nextItem = iterator();\r\n\r\n        if (nextItem === null) {\r\n            done = true;\r\n            return false;\r\n        }\r\n\r\n        items.push(nextItem);\r\n        cancellers.push(item.cancel);\r\n        delete item.cancel;\r\n\r\n        waiting++;\r\n        item.num = 1; // tell _semTake that we still need tokens\r\n        item.taken = 0; // reset taken to prevent unfair taken of this item\r\n\r\n        return true;\r\n    };\r\n\r\n    const replenish = () => {\r\n        if (loops++ !== 0) {\r\n            return;\r\n        }\r\n\r\n        for (; loops > 0; loops--) {\r\n            if (!canceled && --waiting === 0 && done) {\r\n                callback(errors.length === 0 ? undefined : errors);\r\n            }\r\n            this.semGive();\r\n        }\r\n    };\r\n\r\n    const onTake = () => {\r\n        if (hasError || items.length === item.scheduled) {\r\n            replenish();\r\n            return;\r\n        }\r\n\r\n        const i = item.scheduled;\r\n        const nextItem = items[i];\r\n        cancellers[i] = null;\r\n        item.scheduled++;\r\n\r\n        const give = err => {\r\n            nextItem.done = true;\r\n\r\n            cancellers[i] = undefined;\r\n\r\n            if (err) {\r\n                hasError = true;\r\n                errors[i] = err;\r\n                nextItem.error = err;\r\n            }\r\n\r\n            replenish();\r\n        };\r\n\r\n        const {key, value} = nextItem;\r\n        nextItem.done = false;\r\n        nextItem.iteratee = typeof iteratee === \"function\" ? iteratee : value;\r\n        const icancel = typeof iteratee === \"function\" ? iteratee(value, key, give) : value(give);\r\n\r\n        if (cancellers[i] !== undefined && icancel) {\r\n            cancellers[i] = () => {\r\n                cancellers[i] = null;\r\n\r\n                if (typeof icancel === \"function\") {\r\n                    icancel();\r\n                } else if (typeof icancel === \"object\") {\r\n                    if (typeof icancel.cancel === \"function\") {\r\n                        icancel.cancel();\r\n                    } else if (typeof icancel.abort === \"function\") {\r\n                        icancel.abort();\r\n                    }\r\n                }\r\n            };\r\n        }\r\n    };\r\n\r\n    const onCancel = () => {\r\n        canceled = true;\r\n\r\n        if (!done) {\r\n            this._removeItem(item); // remove item since there is no more token needed and _semTake will not remove it\r\n        }\r\n\r\n        cancellers.forEach(cancel => {\r\n            if (typeof cancel === \"function\") {\r\n                cancel();\r\n            }\r\n        });\r\n\r\n        const err = new Error(\"canceled\");\r\n        err.code = \"CANCELED\";\r\n        callback(err);\r\n    };\r\n\r\n    waiting++;\r\n    item = this.semTake({\r\n        priority,\r\n        onTake,\r\n        hasNext,\r\n    }, _item => {\r\n        item = _item;\r\n        item.scheduled = 0;\r\n    });\r\n\r\n    if (waiting === 0) {\r\n        return item;\r\n    }\r\n\r\n    return new Proxy(item, {\r\n        get(target, prop, receiver) {\r\n            if (prop === \"cancel\") {\r\n                return waiting === 0 || canceled ? undefined : onCancel;\r\n            }\r\n\r\n            if (prop === \"setPriority\") {\r\n                return target.setPriority.bind(target);\r\n            }\r\n\r\n            if (prop === \"scheduled\") {\r\n                return Reflect.get(...arguments);\r\n            }\r\n\r\n            return undefined;\r\n        }\r\n    });\r\n};\r\n\r\nSemaphore.prototype._insertItem = function(item) {\r\n    let group = this._queue.get({\r\n        priority: item.priority\r\n    });\r\n    if (!group) {\r\n        group = this._insertGroup(item);\r\n    }\r\n    group.stack.insert(item);\r\n    item.group = group;\r\n};\r\n\r\nSemaphore.prototype._checkKeepAlive = function _checkKeepAlive(_destroyWaiting) {\r\n    if (this._hasInWaitingTask()) {\r\n        return true;\r\n    }\r\n\r\n    if (this.keepAlive) {\r\n        clearTimeout(this.keepAlive);\r\n        delete this.keepAlive;\r\n    }\r\n\r\n    if (_destroyWaiting) {\r\n        this._destroy();\r\n    }\r\n\r\n    return false;\r\n};\r\n\r\nSemaphore.prototype.isAlive = function isAlive() {\r\n    return Boolean(this.keepAlive);\r\n};\r\n\r\nSemaphore.prototype.hasInWaitingTask = function hasInWaitingTask() {\r\n    return hasProp.call(this, \"_queue\") && this._hasInWaitingTask();\r\n};\r\n\r\nSemaphore.prototype._countInWaitingTokens = function _countInWaitingTokens() {\r\n    let count = 0;\r\n\r\n    if (!this.hasInWaitingTask()) {\r\n        return count;\r\n    }\r\n\r\n    let iterator = this._queue.beginIterator();\r\n\r\n    let group, itemIterator, item;\r\n    while (iterator) {\r\n        group = iterator.value();\r\n\r\n        if (group != null && group.stack.length !== 0) {\r\n            itemIterator = group.stack.beginIterator();\r\n\r\n            while (itemIterator) {\r\n                item = itemIterator.value();\r\n                if (item != null) {\r\n                    count += item.num;\r\n                }\r\n                itemIterator = itemIterator.next();\r\n            }\r\n        }\r\n\r\n        iterator = iterator.next();\r\n    }\r\n\r\n    return count;\r\n};\r\n\r\nSemaphore.prototype._hasInWaitingTask = function _hasInWaitingTask() {\r\n    return this._queue.length !== 0;\r\n};\r\n\r\nSemaphore.prototype._keepAlive = function _keepAlive() {\r\n    if (!this._hasInWaitingTask()) {\r\n        return;\r\n    }\r\n    const _this = this;\r\n    this.keepAlive = setTimeout(() => {\r\n        _this._keepAlive();\r\n    }, 1000);\r\n};\r\n\r\n/**\r\n * Remove item from a priority group\r\n *\r\n */\r\nSemaphore.prototype._removeItem = function _removeItem(item) {\r\n    if (item.timer) {\r\n        clearTimeout(item.timer);\r\n    }\r\n\r\n    item.group.stack.remove(item);\r\n\r\n    if (item.group.stack.length === 0) {\r\n        // No more inWaiting for this priority group\r\n        this._queue.remove(item.group);\r\n\r\n        this._checkKeepAlive();\r\n    }\r\n\r\n    item.destroy();\r\n};\r\n\r\nSemaphore.prototype._insertGroup = function _insertGroup(item) {\r\n    const stack = new SortedSet({\r\n        comparator: idComparator,\r\n        strategy: RedBlackTreeStrategy,\r\n        allowNode: true\r\n    });\r\n\r\n    const group = {\r\n        priority: item.priority,\r\n        stack\r\n    };\r\n    this._queue.insert(group);\r\n    return group;\r\n};\r\n\r\nSemaphore.prototype._setImmediate = (() => {\r\n    if (typeof global === \"object\" && typeof global.setImmediate === \"function\") {\r\n        return global.setImmediate;\r\n    }\r\n\r\n    return fn => {\r\n        return setTimeout(fn, 1);\r\n    };\r\n})();\r\n\r\nSemaphore.prototype._clearImmediate = (() => {\r\n    if (typeof global === \"object\" && typeof global.clearImmediate === \"function\") {\r\n        return global.clearImmediate;\r\n    }\r\n\r\n    return id => {\r\n        clearTimeout(id);\r\n    };\r\n})();\r\n\r\nmodule.exports = Semaphore;\r\n\n\n\n// WEBPACK FOOTER //\n// ./lib/Semaphore.js","var g;\r\n\r\n// This works in non-strict mode\r\ng = (function() {\r\n\treturn this;\r\n})();\r\n\r\ntry {\r\n\t// This works if eval is allowed (see CSP)\r\n\tg = g || Function(\"return this\")() || (1,eval)(\"this\");\r\n} catch(e) {\r\n\t// This works if the window reference is available\r\n\tif(typeof window === \"object\")\r\n\t\tg = window;\r\n}\r\n\r\n// g can still be undefined, but nothing to do about it...\r\n// We return undefined, instead of nothing here, so it's\r\n// easier to handle this case. if(!global) { ...}\r\n\r\nmodule.exports = g;\r\n\n\n\n// WEBPACK FOOTER //\n// (webpack)/buildin/global.js","module.exports = class AbstractSortedSet {\r\n    constructor(options) {\r\n        if (options === null || typeof options !== \"object\" || typeof options.strategy !== \"function\") {\r\n            throw new Error(\"Must pass options.strategy, a strategy\");\r\n        }\r\n        if (options === null || typeof options !== \"object\" || typeof options.comparator !== \"function\") {\r\n            throw new Error(\"Must pass options.comparator, a comparator\");\r\n        }\r\n        this.priv = new options.strategy(options);\r\n        this.length = 0;\r\n    }\r\n\r\n    insert(value) {\r\n        this.priv.insert(value);\r\n        this.length += 1;\r\n        return this;\r\n    }\r\n\r\n    remove(value) {\r\n        this.priv.remove(value);\r\n        this.length -= 1;\r\n        return this;\r\n    }\r\n\r\n    contains(value) {\r\n        return this.priv.contains(value);\r\n    }\r\n\r\n    // Returns this set as an Array\r\n    toArray() {\r\n        return this.priv.toArray();\r\n    }\r\n\r\n    forEach(callback, thisArg) {\r\n        this.priv.forEachImpl(callback, this, thisArg);\r\n    }\r\n\r\n    map(callback, thisArg) {\r\n        const ret = [];\r\n        this.priv.forEachImpl((value, index, self) => {\r\n            ret.push(callback.call(thisArg, value, index, self));\r\n        }, this, thisArg);\r\n        return ret;\r\n    }\r\n\r\n    filter(callback, thisArg) {\r\n        const ret = [];\r\n        this.priv.forEachImpl((value, index, self) => {\r\n            if (callback.call(thisArg, value, index, self)) {\r\n                ret.push(value);\r\n            }\r\n        }, this, thisArg);\r\n        return ret;\r\n    }\r\n\r\n    every(callback, thisArg) {\r\n        let ret = true;\r\n        this.priv.forEachImpl((value, index, self) => {\r\n            if (!callback.call(thisArg, value, index, self)) {\r\n                ret = false;\r\n            }\r\n            return !ret;\r\n        }, this, thisArg, true);\r\n        return ret;\r\n    }\r\n\r\n    some(callback, thisArg) {\r\n        let ret = false;\r\n        this.priv.forEachImpl((value, index, self) => {\r\n            if (callback.call(thisArg, value, index, self)) {\r\n                ret = true;\r\n            }\r\n            return ret;\r\n        }, this, thisArg);\r\n        return ret;\r\n    }\r\n\r\n    // An iterator is similar to a C++ iterator: it points _before_ a value.\r\n\r\n    // So in this sorted set:\r\n\r\n    //   | 1 | 2 | 3 | 4 | 5 |\r\n    //   ^a      ^b          ^c\r\n\r\n    // `a` is a pointer to the beginning of the iterator. `a.value()` returns\r\n    // `3`. `a.previous()` returns `null`. `a.setValue()` works, if\r\n    // `options.allowSetValue` is true.\r\n\r\n    // `b` is a pointer to the value `3`. `a.previous()` and `a.next()` both do\r\n    // the obvious.\r\n\r\n    // `c` is a pointer to the `null` value. `c.previous()` works; `c.next()`\r\n    // returns null. `c.setValue()` throws an exception, even if\r\n    // `options.allowSetValue` is true.\r\n\r\n    // Iterators have `hasNext()` and `hasPrevious()` methods, too.\r\n\r\n    // Iterators are immutible. `iterator.next()` returns a new iterator.\r\n\r\n    // Iterators become invalid as soon as `insert()` or `remove()` is called.\r\n    findIterator(value) {\r\n        return this.priv.findIterator(value);\r\n    }\r\n\r\n    // Finds an iterator pointing to the lowest possible value.\r\n    beginIterator() {\r\n        return this.priv.beginIterator();\r\n    }\r\n\r\n    // Finds an iterator pointing to the `null` value.\r\n    endIterator() {\r\n        return this.priv.endIterator();\r\n    }\r\n};\r\n\n\n\n// WEBPACK FOOTER //\n// ./lib/SortedSet/AbstractSortedSet.js","const AbstractBinaryTreeStrategy = require(\"./AbstractBinaryTreeStrategy\");\r\nconst RedBlackTreeNode = require(\"./RedBlackTreeNode\");\r\n\r\n// An implementation of Left-Leaning Red-Black trees.\r\n\r\n// It's copied from http://www.cs.princeton.edu/~rs/talks/LLRB/LLRB.pdf.\r\n// It's practically a copy-paste job, minus the semicolons. missing bits were\r\n// filled in with hints from\r\n// https://www.teachsolaisgames.com/articles/balanced_left_leaning.html\r\n\r\nconst rotateLeft = node => {\r\n    const tmp = node.right;\r\n    tmp.parent = null;\r\n\r\n    node.right = tmp.left;\r\n    if (node.right !== null) {\r\n        node.right.parent = node;\r\n    }\r\n\r\n    tmp.left = node;\r\n    if (tmp.left !== null) {\r\n        tmp.left.parent = tmp;\r\n    }\r\n    tmp.isRed = node.isRed;\r\n    node.isRed = true;\r\n    return tmp;\r\n};\r\n\r\nconst rotateRight = node => {\r\n    const tmp = node.left;\r\n    tmp.parent = null;\r\n\r\n    node.left = tmp.right;\r\n    if (node.left !== null) {\r\n        node.left.parent = node;\r\n    }\r\n\r\n    tmp.right = node;\r\n    if (tmp.right !== null) {\r\n        tmp.right.parent = tmp;\r\n    }\r\n\r\n    tmp.isRed = node.isRed;\r\n    node.isRed = true;\r\n    return tmp;\r\n};\r\n\r\nconst colorFlip = node => {\r\n    node.isRed = !node.isRed;\r\n    node.left.isRed = !node.left.isRed;\r\n    node.right.isRed = !node.right.isRed;\r\n};\r\n\r\nconst moveRedLeft = node => {\r\n    //throw 'Preconditions failed' if !(!node.left.isRed && !node.left.left?.isRed)\r\n    colorFlip(node);\r\n    if (node.right !== null && node.right.left !== null && node.right.left.isRed) {\r\n        node.right = rotateRight(node.right);\r\n        node.right.parent = node;\r\n        node = rotateLeft(node);\r\n        colorFlip(node);\r\n    }\r\n    return node;\r\n};\r\n\r\nconst moveRedRight = node => {\r\n    //throw 'Preconditions failed' if !(!node.right.isRed && !node.right.left?.isRed)\r\n    colorFlip(node);\r\n    if (node.left !== null && node.left.left !== null && node.left.left.isRed) {\r\n        node = rotateRight(node);\r\n        colorFlip(node);\r\n    }\r\n    return node;\r\n};\r\n\r\nconst insertInNode = (node, value, compare, allowNode, parent) => {\r\n    if (node === null) {\r\n        if (allowNode && value instanceof RedBlackTreeNode) {\r\n            if (!value.isRed) {\r\n                value.isRed = true;\r\n            }\r\n            return value;\r\n        }\r\n        return new RedBlackTreeNode(value);\r\n    }\r\n\r\n    //if node.left isnt null && node.left.isRed && node.right isnt null && node.right.isRed\r\n    //  colorFlip(node)\r\n    if (node.value === value) {\r\n        throw new Error(\"Value already in set\");\r\n    }\r\n\r\n    if (compare(value, node.value) < 0) {\r\n        node.left = insertInNode(node.left, value, compare, allowNode, node);\r\n        node.left.parent = node;\r\n    } else {\r\n        node.right = insertInNode(node.right, value, compare, allowNode, node);\r\n        node.right.parent = node;\r\n    }\r\n\r\n    if (node.right !== null && node.right.isRed && !(node.left !== null && node.left.isRed)) {\r\n        node = rotateLeft(node);\r\n    }\r\n\r\n    if (node.left !== null && node.left.isRed && node.left.left !== null && node.left.left.isRed) {\r\n        node = rotateRight(node);\r\n    }\r\n\r\n    // Put this here -- I couldn't get the whole thing to work otherwise :(\r\n    if (node.left !== null && node.left.isRed && node.right !== null && node.right.isRed) {\r\n        colorFlip(node);\r\n    }\r\n\r\n    return node;\r\n};\r\n\r\nconst findMinNode = node => {\r\n    while (node.left !== null) {\r\n        node = node.left;\r\n    }\r\n    return node;\r\n};\r\n\r\nconst fixUp = node => {\r\n    // Fix right-leaning red nodes\r\n    if (node.right !== null && node.right.isRed) {\r\n        node = rotateLeft(node);\r\n    }\r\n\r\n    // Handle a 4-node that traverses down the left\r\n    if (node.left !== null && node.left.isRed && node.left.left !== null && node.left.left.isRed) {\r\n        node = rotateRight(node);\r\n    }\r\n\r\n    // split 4-nodes\r\n    if (node.left !== null && node.left.isRed && node.right !== null && node.right.isRed) {\r\n        colorFlip(node);\r\n    }\r\n\r\n    return node;\r\n};\r\n\r\nconst removeMinNode = node => {\r\n    if (node.left === null) {\r\n        return null;\r\n    }\r\n    if (!node.left.isRed && !(node.left.left !== null && node.left.left.isRed)) {\r\n        node = moveRedLeft(node);\r\n    }\r\n    node.left = removeMinNode(node.left);\r\n    if (node.left !== null) {\r\n        node.left.parent = node;\r\n    }\r\n    return fixUp(node);\r\n};\r\n\r\n// // const removeMinNodeStack = new Array(1024);\r\n// const removeMinNode = node => {\r\n//     let pos = 0;\r\n//     const removeMinNodeStack = [];\r\n//     removeMinNodeStack[pos++] = node;\r\n//     removeMinNodeStack[pos++] = 0;\r\n//     // let stackSize = pos;\r\n//     let ret;\r\n\r\n//     while (pos !== 0) {\r\n//         // if (pos > stackSize) {\r\n//         //     stackSize = pos;\r\n//         // }\r\n//         if (removeMinNodeStack[--pos] === 0) {\r\n//             node = removeMinNodeStack[--pos];\r\n\r\n//             if (node.left === null) {\r\n//                 ret = null;\r\n//                 continue;\r\n//             }\r\n\r\n//             if (!node.left.isRed && !(node.left.left !== null && node.left.left.isRed)) {\r\n//                 node = moveRedLeft(node);\r\n//             }\r\n\r\n//             removeMinNodeStack[pos++] = node;\r\n//             removeMinNodeStack[pos++] = 1;\r\n//             removeMinNodeStack[pos++] = node.left;\r\n//             removeMinNodeStack[pos++] = 0;\r\n//         } else {\r\n//             node = removeMinNodeStack[--pos];\r\n//             node.left = ret;\r\n//             if (node.left !== null) {\r\n//                 node.left.parent = node;\r\n//             }\r\n//             ret = fixUp(node);\r\n//         }\r\n//     }\r\n\r\n//     // for (let i = 0; i < stackSize; i++) {\r\n//     //     removeMinNodeStack[i] = undefined;\r\n//     // }\r\n\r\n//     return ret;\r\n// };\r\n\r\nconst removeFromNode = (node, value, compare, allowNode) => {\r\n    if (node === null) {\r\n        throw new Error(\"Value not in set\");\r\n    }\r\n\r\n    if (node.value !== value && compare(value, node.value) < 0) {\r\n        if (node.left === null) {\r\n            throw new Error(\"Value not in set\");\r\n        }\r\n \r\n        if (!node.left.isRed && !(node.left.left !== null && node.left.left.isRed)) {\r\n            node = moveRedLeft(node);\r\n        }\r\n \r\n        node.left = removeFromNode(node.left, value, compare, allowNode);\r\n        if (node.left !== null) {\r\n            node.left.parent = node;\r\n        }\r\n    } else {\r\n        if (node.left !== null && node.left.isRed) {\r\n            node = rotateRight(node);\r\n        }\r\n        if (node.right === null) {\r\n            if (value === node.value) {\r\n                return null; // leaf node; LLRB assures no left value here\r\n            }\r\n            throw new Error(\"Value not in set\");\r\n        }\r\n        if (!node.right.isRed && !(node.right.left !== null && node.right.left.isRed)) {\r\n            node = moveRedRight(node);\r\n        }\r\n        if (value === node.value) {\r\n            value = findMinNode(node.right).value;\r\n            const right = removeMinNode(node.right);\r\n\r\n            if (allowNode && value instanceof RedBlackTreeNode) {\r\n                value.left = node.left;\r\n                if (value.left !== null) {\r\n                    value.left.parent = value;\r\n                }\r\n                value.parent = node.parent;\r\n                value.isRed = node.isRed;\r\n                node = value;\r\n            }\r\n\r\n            node.value = value;\r\n            node.right = right;\r\n        } else {\r\n            node.right = removeFromNode(node.right, value, compare, allowNode);\r\n        }\r\n\r\n        if (node.right !== null) {\r\n            node.right.parent = node;\r\n        }\r\n    }\r\n\r\n    return fixUp(node);\r\n};\r\n\r\n// // const removeFromNodeStask = new Array(1024);\r\n// const removeFromNode = (node, value, compare, allowNode) => {\r\n//     let pos = 0;\r\n//     const removeFromNodeStask = [];\r\n//     removeFromNodeStask[pos++] = node;\r\n//     removeFromNodeStask[pos++] = 0;\r\n//     // let stackSize = pos;\r\n//     let ret, cmd;\r\n\r\n//     while (pos !== 0) {\r\n//         // if (pos > stackSize) {\r\n//         //     stackSize = pos;\r\n//         // }\r\n//         cmd = removeFromNodeStask[--pos];\r\n\r\n//         // eslint-disable-next-line default-case\r\n//         switch(cmd) {\r\n//             case 0:\r\n//                 node = removeFromNodeStask[--pos];\r\n\r\n//                 if (node === null) {\r\n//                     throw new Error(\"Value not in set\");\r\n//                 }\r\n\r\n//                 if (node.value !== value && compare(value, node.value) < 0) {\r\n//                     if (node.left === null) {\r\n//                         throw new Error(\"Value not in set\");\r\n//                     }\r\n//                     if (!node.left.isRed && !(node.left.left !== null && node.left.left.isRed)) {\r\n//                         node = moveRedLeft(node);\r\n//                     }\r\n//                     removeFromNodeStask[pos++] = node;\r\n//                     removeFromNodeStask[pos++] = 1;\r\n//                     removeFromNodeStask[pos++] = node.left;\r\n//                     removeFromNodeStask[pos++] = 0;\r\n//                     break;\r\n//                 }\r\n\r\n//                 if (node.left !== null && node.left.isRed) {\r\n//                     node = rotateRight(node);\r\n//                 }\r\n\r\n//                 if (node.right === null) {\r\n//                     if (value === node.value) {\r\n//                         ret = null; // leaf node; LLRB assures no left value here\r\n//                         break;\r\n//                     }\r\n//                     throw new Error(\"Value not in set\");\r\n//                 }\r\n\r\n//                 if (!node.right.isRed && !(node.right.left !== null && node.right.left.isRed)) {\r\n//                     node = moveRedRight(node);\r\n//                 }\r\n\r\n//                 if (value === node.value) {\r\n//                     value = findMinNode(node.right).value;\r\n//                     const right = removeMinNode(node.right);\r\n\r\n//                     if (allowNode && value instanceof RedBlackTreeNode) {\r\n//                         value.left = node.left;\r\n//                         if (value.left !== null) {\r\n//                             value.left.parent = value;\r\n//                         }\r\n//                         value.parent = node.parent;\r\n//                         value.isRed = node.isRed;\r\n//                         node = value;\r\n//                     }\r\n\r\n//                     node.value = value;\r\n//                     node.right = right;\r\n\r\n//                     if (node.right !== null) {\r\n//                         node.right.parent = node;\r\n//                     }\r\n//                     ret = fixUp(node);\r\n//                     break;\r\n//                 }\r\n\r\n//                 removeFromNodeStask[pos++] = node;\r\n//                 removeFromNodeStask[pos++] = 2;\r\n//                 removeFromNodeStask[pos++] = node.right;\r\n//                 removeFromNodeStask[pos++] = 0;\r\n//                 break;\r\n//             case 1:\r\n//                 node = removeFromNodeStask[--pos];\r\n//                 node.left = ret;\r\n//                 if (node.left !== null) {\r\n//                     node.left.parent = node;\r\n//                 }\r\n//                 ret = fixUp(node);\r\n//                 break;\r\n//             case 2:\r\n//                 node = removeFromNodeStask[--pos];\r\n//                 node.right = ret;\r\n//                 if (node.right !== null) {\r\n//                     node.right.parent = node;\r\n//                 }\r\n//                 ret = fixUp(node);\r\n//                 break;\r\n//         }\r\n//     }\r\n\r\n//     // for (let i = 0; i < stackSize; i++) {\r\n//     //     removeFromNodeStask[i] = undefined;\r\n//     // }\r\n\r\n//     return ret;\r\n// };\r\n\r\nmodule.exports = class RedBlackTreeStrategy extends AbstractBinaryTreeStrategy {\r\n    insert(value) {\r\n        this.root = insertInNode(this.root, value, this.comparator, this.allowNode);\r\n        this.root.parent = null;\r\n        this.root.isRed = false;\r\n    }\r\n\r\n    remove(value) {\r\n        this.root = removeFromNode(this.root, value, this.comparator, this.allowNode);\r\n        if (this.root !== null) {\r\n            this.root.parent = null;\r\n            this.root.isRed = false;\r\n        }\r\n    }\r\n};\r\n\n\n\n// WEBPACK FOOTER //\n// ./lib/SortedSet/RedBlackTreeStrategy.js","const BinaryTreeIterator = require(\"./BinaryTreeIterator\");\r\n\r\n// const binaryTreeTraverse = (node, callback, some) => {\r\n//     if (node === null) {\r\n//         return false;\r\n//     }\r\n\r\n//     let ret;\r\n\r\n//     ret = binaryTreeTraverse(node.left, callback, some);\r\n//     if (some && ret) {\r\n//         return true;\r\n//     }\r\n\r\n//     ret = callback(node.value);\r\n//     if (some && ret) {\r\n//         return true;\r\n//     }\r\n\r\n//     ret = binaryTreeTraverse(node.right, callback, some);\r\n//     if (some && ret) {\r\n//         return true;\r\n//     }\r\n\r\n//     return false;\r\n// };\r\n\r\n// Not subject to stackoverflow\r\nconst binaryTreeTraverse = (node, callback, some) => {\r\n    if (node === null) {\r\n        return;\r\n    }\r\n\r\n    const stack = [1, node.right, 0, node.value, 1, node.left];\r\n    let pos = stack.length;\r\n    let ret;\r\n\r\n    while (pos !== 0) {\r\n        pos -= 2;\r\n        node = stack[pos + 1];\r\n        if (stack[pos] === 0) {\r\n            ret = callback(node);\r\n            if (some && ret) {\r\n                break;\r\n            }\r\n        } else if (node !== null) {\r\n            stack[pos++] = 1;\r\n            stack[pos++] = node.right;\r\n            stack[pos++] = 0;\r\n            stack[pos++] = node.value;\r\n            stack[pos++] = -1;\r\n            stack[pos++] = node.left;\r\n        }\r\n    }\r\n};\r\n\r\n// An AbstractBinaryTreeStrategy has a @root. @root is null or an object with\r\n// `.left`, `.right` and `.value` properties.\r\nmodule.exports = class AbstractBinaryTreeStrategy {\r\n    constructor(options) {\r\n        this.root = null;\r\n        this.comparator = options.comparator;\r\n        this.allowSetValue = options.allowSetValue;\r\n        this.allowNode = options.allowNode;\r\n    }\r\n\r\n    toArray() {\r\n        const ret = [];\r\n        binaryTreeTraverse(this.root, value => {\r\n            ret.push(value);\r\n        });\r\n        return ret;\r\n    }\r\n\r\n    forEachImpl(callback, sortedSet, thisArg, some) {\r\n        if (typeof thisArg === \"undefined\") {\r\n            thisArg = sortedSet;\r\n        }\r\n        let i = 0;\r\n        binaryTreeTraverse(this.root, value => {\r\n            return callback.call(thisArg, value, i++, sortedSet);\r\n        }, some);\r\n    }\r\n\r\n    contains(value) {\r\n        const {comparator} = this;\r\n        let {root: node} = this;\r\n        let cmp;\r\n\r\n        while (node !== null) {\r\n            cmp = comparator(value, node.value);\r\n            if (cmp === 0) {\r\n                break;\r\n            } else if (cmp < 0) {\r\n                node = node.left;\r\n            } else {\r\n                node = node.right;\r\n            }\r\n        }\r\n\r\n        return node !== null && node.value === value;\r\n    }\r\n\r\n    findIterator(value) {\r\n        return BinaryTreeIterator.find(this, value, this.comparator);\r\n    }\r\n\r\n    beginIterator() {\r\n        return BinaryTreeIterator.left(this);\r\n    }\r\n\r\n    endIterator() {\r\n        return BinaryTreeIterator.right(this);\r\n    }\r\n};\r\n\n\n\n// WEBPACK FOOTER //\n// ./lib/SortedSet/AbstractBinaryTreeStrategy.js","const descendAllTheWay = (leftOrRight, node) => {\r\n    while (node[leftOrRight] !== null) {\r\n        node = node[leftOrRight];\r\n    }\r\n    return node;\r\n};\r\n\r\nconst moveCursor = (leftOrRight, node) => {\r\n    let parent, rightOrLeft;\r\n    if (node[leftOrRight] !== null) {\r\n        parent = node;\r\n        node = node[leftOrRight];\r\n        rightOrLeft = leftOrRight === \"left\" ? \"right\" : \"left\";\r\n        node = descendAllTheWay(rightOrLeft, node);\r\n    } else {\r\n        while ((parent = node.parent) !== null && parent[leftOrRight] === node) {\r\n            node = parent;\r\n        }\r\n        node = parent; // either null or the correct-direction parent\r\n    }\r\n    return node;\r\n};\r\n\r\n// The BinaryTreeIterator actually writes to the tree: it maintains a\r\n// \"parent\" variable on each node. Please ignore this.\r\nclass BinaryTreeIterator {\r\n    constructor(tree, node) {\r\n        this.tree = tree;\r\n        this.node = node;\r\n    }\r\n\r\n    next() {\r\n        if (this.node === null) {\r\n            return null;\r\n        }\r\n        const node = moveCursor(\"right\", this.node);\r\n        return node === null ? null : new BinaryTreeIterator(this.tree, node);\r\n    }\r\n\r\n    previous() {\r\n        if (this.node === null) {\r\n            if (this.tree.root === null) {\r\n                return null;\r\n            }\r\n\r\n            const node = descendAllTheWay(\"right\", this.tree.root);\r\n            return node === null ? null : new BinaryTreeIterator(this.tree, node);\r\n        }\r\n\r\n        const node = moveCursor(\"left\", this.node);\r\n        return node === null ? null : new BinaryTreeIterator(this.tree, node);\r\n    }\r\n\r\n    hasNext() {\r\n        return this.next() !== null;\r\n    }\r\n\r\n    hasPrevious() {\r\n        return this.previous() !== null;\r\n    }\r\n\r\n    value() {\r\n        return this.node === null ? null : this.node.value;\r\n    }\r\n\r\n    setValue(value) {\r\n        if (!this.tree.allowSetValue) {\r\n            throw new Error(\"Must set options.allowSetValue\");\r\n        }\r\n        if (this.node === null) {\r\n            throw new Error(\"Cannot set value at end of set\");\r\n        }\r\n        this.node.value = value;\r\n        return value;\r\n    }\r\n}\r\n\r\nBinaryTreeIterator.find = (tree, value, comparator) => {\r\n    let {root: node} = tree;\r\n    let nextNode = null; // For finding an in-between node\r\n    let cmp;\r\n\r\n    while (node !== null) {\r\n        cmp = comparator(value, node.value);\r\n        if (cmp === 0) {\r\n            break;\r\n        }\r\n\r\n        if (cmp < 0) {\r\n            if (node.left === null) {\r\n                break;\r\n            }\r\n\r\n            // If we descend all right after this until there are\r\n            // no more right nodes, we want to return an\r\n            // \"in-between\" iterator ... pointing here.\r\n            nextNode = node;\r\n            node = node.left;\r\n        } else if (node.right !== null) {\r\n            node = node.right;\r\n        } else {\r\n            node = nextNode;\r\n            break;\r\n        }\r\n    }\r\n\r\n    return new BinaryTreeIterator(tree, node);\r\n};\r\n\r\nBinaryTreeIterator.left = tree => {\r\n    if (tree.root === null) {\r\n        return new BinaryTreeIterator(tree, null);\r\n    }\r\n\r\n    const node = descendAllTheWay(\"left\", tree.root);\r\n    return new BinaryTreeIterator(tree, node);\r\n};\r\n\r\nBinaryTreeIterator.right = tree => {\r\n    return new BinaryTreeIterator(tree, null);\r\n};\r\n\r\nmodule.exports = BinaryTreeIterator;\r\n\n\n\n// WEBPACK FOOTER //\n// ./lib/SortedSet/BinaryTreeIterator.js","module.exports = class BinaryTreeNode {\r\n    constructor(value, parent = null) {\r\n        this.value = value;\r\n        this.left = null;\r\n        this.right = null;\r\n        this.parent = parent;\r\n    }\r\n};\r\n\n\n\n// WEBPACK FOOTER //\n// ./lib/SortedSet/BinaryTreeNode.js","const createArrayIterator = arr => {\r\n    let i = 0;\r\n    const len = arr.length;\r\n\r\n    return function next() {\r\n        return i < len ? {\r\n            key: i,\r\n            value: arr[i++],\r\n        } : null;\r\n    };\r\n};\r\n\r\nconst createObjectIterator = obj => {\r\n    let i = 0;\r\n    const keys = Object.keys(obj);\r\n    const len = keys.length;\r\n\r\n    return function next() {\r\n        return i < len ? {\r\n            key: keys[i],\r\n            value: obj[keys[i++]]\r\n        } : null;\r\n    };\r\n};\r\n\r\nconst createIterableIterator = iterable => {\r\n    const iterator = iterable[Symbol.iterator]();\r\n    return function next() {\r\n        const item = iterator.next();\r\n        return item === null || typeof item !== \"object\" ? item : item.done ? null : item;\r\n    };\r\n};\r\n\r\nconst iterator = obj => {\r\n    if (obj === null || typeof obj !== \"object\") {\r\n        return null;\r\n    }\r\n\r\n    return Array.isArray(obj) ? createArrayIterator(obj) : Symbol.iterator in obj ? createIterableIterator(obj) : createObjectIterator(obj);\r\n};\r\n\r\nmodule.exports = iterator;\r\n\n\n\n// WEBPACK FOOTER //\n// ./lib/iterator.js"],"sourceRoot":""}