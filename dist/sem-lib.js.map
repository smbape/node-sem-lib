{"version":3,"sources":["webpack:///webpack/universalModuleDefinition","webpack:///webpack/bootstrap 9b8d1faf4b8761af9125","webpack:///./lib/sem-lib.js","webpack:///(webpack)/buildin/global.js","webpack:///./node_modules/js-sorted-set/src/SortedSet/AbstractSortedSet.coffee","webpack:///./node_modules/js-sorted-set/src/SortedSet/RedBlackTreeStrategy.coffee","webpack:///./node_modules/js-sorted-set/src/SortedSet/AbstractBinaryTreeStrategy.coffee","webpack:///./node_modules/js-sorted-set/src/SortedSet/BinaryTreeIterator.coffee"],"names":["AbstractSortedSet","require","RedBlackTreeStrategy","hasProp","Object","hasOwnProperty","inherits","child","parent","key","call","ctor","constructor","prototype","__super__","SortedSet","options","strategy","add","insert","get","value","priv","comparator","node","root","cmp","left","right","undefined","isNumeric","obj","Array","isArray","parsed","parseFloat","isObject","globalCounter","toInteger","num","positive","_default","Number","POSITIVE_INFINITY","NEGATIVE_INFINITY","parseInt","Semaphore","capacity","isFull","priority","sync","_queue","priorityComparator","id","_capacity","_numTokens","setImmediateTick","global","setImmediate","fn","setTimeout","_clearImmediateTick","clearImmediate","clearTimeout","getNumTokens","getCapacity","setCapacity","semGive","isGivenBack","destroyed","_semTake","semFlush","forEach","group","stack","item","semTake","result","task","timeOut","onTimeOut","onCancel","unfair","shouldTakeToken","onTake","Function","semaphore","taken","cancel","_removeItem","setPriority","nextPriority","remove","length","_addItemPriority","timer","res","addCounter","nextNum","hasResult","disable","_shouldTakeToken","_nextGroupItem","groupIterator","itemIterator","beginIterator","Math","min","next","topSync","taking","keepAlive","_keepAlive","weakerIterator","wearkeGroup","weakerItemIterator","weakerItem","endIterator","previous","hasPrevious","timerID","_checkKeepAlive","_destroyWaiting","destroy","safe","onDestroy","_destroying","__onDestroy","_destroy","i","_len","schedule","collection","iteratee","callback","semID","arguments","count","index","keys","len","items","doneCalled","canceled","errors","hasError","coll","called","err","Error","code","icancel","abort","iterate","bind","proxy","defineProperty","configurable","enumerable","set","loop","size","_addGroup","_hasInWaitingTask","isAlive","Boolean","hasInWaitingTask","_countInWaitingTokens","iterator","itemerator","hasNext","_this","property","idComparator","a","b","exports","semCreate","create","apply","g","eval","e","window","module"],"mappings":"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","file":"sem-lib.js","sourcesContent":["(function webpackUniversalModuleDefinition(root, factory) {\n\tif(typeof exports === 'object' && typeof module === 'object')\n\t\tmodule.exports = factory();\n\telse if(typeof define === 'function' && define.amd)\n\t\tdefine([], factory);\n\telse if(typeof exports === 'object')\n\t\texports[\"semLib\"] = factory();\n\telse\n\t\troot[\"semLib\"] = factory();\n})(typeof self !== 'undefined' ? self : this, function() {\nreturn \n\n\n// WEBPACK FOOTER //\n// webpack/universalModuleDefinition"," \t// The module cache\n \tvar installedModules = {};\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId]) {\n \t\t\treturn installedModules[moduleId].exports;\n \t\t}\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\ti: moduleId,\n \t\t\tl: false,\n \t\t\texports: {}\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.l = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// define getter function for harmony exports\n \t__webpack_require__.d = function(exports, name, getter) {\n \t\tif(!__webpack_require__.o(exports, name)) {\n \t\t\tObject.defineProperty(exports, name, {\n \t\t\t\tconfigurable: false,\n \t\t\t\tenumerable: true,\n \t\t\t\tget: getter\n \t\t\t});\n \t\t}\n \t};\n\n \t// getDefaultExport function for compatibility with non-harmony modules\n \t__webpack_require__.n = function(module) {\n \t\tvar getter = module && module.__esModule ?\n \t\t\tfunction getDefault() { return module['default']; } :\n \t\t\tfunction getModuleExports() { return module; };\n \t\t__webpack_require__.d(getter, 'a', getter);\n \t\treturn getter;\n \t};\n\n \t// Object.prototype.hasOwnProperty.call\n \t__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"\";\n\n \t// Load entry module and return exports\n \treturn __webpack_require__(__webpack_require__.s = 0);\n\n\n\n// WEBPACK FOOTER //\n// webpack/bootstrap 9b8d1faf4b8761af9125","const AbstractSortedSet = require(\"js-sorted-set/src/SortedSet/AbstractSortedSet\");\nconst RedBlackTreeStrategy = require(\"js-sorted-set/src/SortedSet/RedBlackTreeStrategy\");\n\nconst hasProp = Object.hasOwnProperty;\n\nconst inherits = function(child, parent) {\n    for (const key in parent) {\n        if (hasProp.call(parent, key)) {\n            child[key] = parent[key];\n        }\n    }\n\n    function ctor() {\n        // eslint-disable-next-line no-invalid-this\n        this.constructor = child;\n    }\n    ctor.prototype = parent.prototype;\n    child.prototype = new ctor();\n    child.__super__ = parent.prototype; return child;\n};\n\nfunction SortedSet(options) {\n    if (options == null) {\n        options = {};\n    }\n    if (!options.strategy) {\n        options.strategy = RedBlackTreeStrategy;\n    }\n    SortedSet.__super__.constructor.call(this, options);\n}\n\ninherits(SortedSet, AbstractSortedSet);\n\nSortedSet.prototype.add = SortedSet.prototype.insert;\n\nSortedSet.prototype.get = function(value) {\n    // Use our optimzed get on RedBlackTreeStrategy\n    return this.priv.get(value);\n};\n\n// Optimization: take the first match.\nRedBlackTreeStrategy.prototype.get = function(value) {\n    const comparator = this.comparator;\n    let node = this.root;\n    let cmp;\n\n    while (node !== null) {\n        cmp = comparator(value, node.value);\n        if (cmp === 0) {\n            break;\n        } else if (cmp < 0) {\n            node = node.left;\n        } else {\n            node = node.right;\n        }\n    }\n\n    return node === null ? undefined : node.value;\n};\n\nconst isNumeric = obj => {\n    if (Array.isArray(obj)) {\n        return false;\n    }\n\n    const parsed = parseFloat(obj);\n    if (obj === parsed) {\n        return true;\n    }\n\n    return obj - parsed + 1 >= 0;\n};\n\nconst isObject = obj => {\n    return typeof obj === \"object\" && obj !== null;\n};\n\n// Debugging purpose\nlet globalCounter = 0;\n\n/**\n * Value of parsed interger or default value if not a number or < 0\n * @param  {Any} num value to parse\n * @param  {Interger} _default default value\n * @return {Interger} parsing result\n */\nfunction toInteger(num, positive, _default) {\n    if (!isNumeric(num)) {\n        return _default;\n    }\n\n    if (num === Number.POSITIVE_INFINITY) {\n        return num;\n    }\n\n    if (num === Number.NEGATIVE_INFINITY) {\n        return positive ? _default : num;\n    }\n\n    num = parseInt(num, 10);\n\n    return positive && num < 0 ? _default : num;\n}\n\n/**\n * @constructor\n *\n * @param {Integer} capacity (default = 1) Number of tokens that can be handled by the Semaphore\n * @param {Boolean} isFull (default = false) if true object is created with tokens\n * @param {Integer} priority (default = 15) default priority\n */\nfunction Semaphore(capacity, isFull, priority, sync = false) {\n    const _queue = new SortedSet({\n        comparator: priorityComparator\n    });\n\n    this.id = ++globalCounter;\n    this._capacity = toInteger(capacity, true, 1);\n    this._queue = _queue;\n    this._numTokens = isFull ? this._capacity : 0;\n    // eslint-disable-next-line no-magic-numbers\n    this.priority = toInteger(priority, false, 15);\n    this.sync = sync;\n}\n\nSemaphore.prototype.setImmediateTick = (function() {\n    if (typeof global === \"object\" && typeof global.setImmediate === \"function\") {\n        return global.setImmediate;\n    }\n\n    return function(fn) {\n        return setTimeout(fn, 1);\n    };\n})();\n\nSemaphore.prototype._clearImmediateTick = (function() {\n    if (typeof global === \"object\" && typeof global.clearImmediate === \"function\") {\n        return global.clearImmediate;\n    }\n\n    return function(id) {\n        clearTimeout(id);\n    };\n})();\n\n/**\n * Return number of available tokens\n * @return {Interger} number of available tokens\n */\nSemaphore.prototype.getNumTokens = function getNumTokens() {\n    return this._numTokens;\n};\n\n/**\n * Return maximum of available tokens\n * @return {Integer} maximum of available tokens\n */\nSemaphore.prototype.getCapacity = function getCapacity() {\n    return this._capacity;\n};\n\n/**\n * Set the maximum of available tokens\n * @return {Integer} maximum of available tokens\n */\nSemaphore.prototype.setCapacity = function getCapacity(capacity) {\n    this._capacity = toInteger(capacity, true, this._capacity);\n};\n\n/**\n * Add tokens to the Semaphore\n *\n * @param {Interger} num Number of tokens to add\n */\nSemaphore.prototype.semGive = function semGive(num, isGivenBack) {\n    if (this.destroyed) {\n        return false;\n    }\n\n    if (num !== Number.POSITIVE_INFINITY) {\n        num = toInteger(num, true, 1);\n        if (num < 1) {\n            num = 1;\n        }\n        this._numTokens += num;\n    } else {\n        this._numTokens = num;\n    }\n\n    if (!isGivenBack && this._numTokens > this._capacity) {\n        this._numTokens = this._capacity;\n    }\n\n    this._semTake(isGivenBack);\n\n    if (isGivenBack && this._numTokens > this._capacity) {\n        this._numTokens = this._capacity;\n    }\n\n    return true;\n};\n\n/**\n * Give tokens to every inwaiting tasks\n */\nSemaphore.prototype.semFlush = function semFlush() {\n    if (this.destroyed) {\n        return false;\n    }\n\n    this._numTokens = 0;\n    this._queue.forEach(group => {\n        group.stack.forEach(item => {\n            item.num = 0;\n        });\n    });\n    this._semTake();\n    return true;\n};\n\n/**\n * Wait for Semaphore availability before calling onTake callback\n * @example\n * semTake(Function[, takeInstance]);\n * semTake(Settings[, takeInstance]);\n *\n * @param {Object} options options with the following properties:\n * <ul>\n * <li>{Function} <b><em>onTake</em></b></li>: called on successful take\n * <li>{Integer} <b><em>num</em></b></li>(optional, default = 1): Number of tokens to take before calling onTake callback\n * <li>{Integer} <b><em>priority</em></b></li>(optional): task priority, smaller is higher priority\n * <li>{Number} <b><em>timeOut</em></b></li>(optional): milliseconds to wait before timeOut. If !(options['timeOut'] > 0), waiting will last forever\n * <li>{Function} <b><em>onTimeOut</em></b></li>(optional): called if timeOut occurs\n * </ul>\n * @return {Object|false} item item.addCounter(n = 1) => wait for n more tokens\n */\nSemaphore.prototype.semTake = function semTake(options, result) {\n    let task, timeOut, onTimeOut, onCancel, num, priority, unfair, shouldTakeToken, sync;\n\n    if (this.destroyed) {\n        return false;\n    }\n\n    if (isObject(options)) {\n        task = options.onTake;\n        priority = options.priority;\n        num = options.num;\n        timeOut = options.timeOut;\n        onTimeOut = options.onTimeOut;\n        onCancel = options.onCancel;\n        unfair = options.unfair;\n        shouldTakeToken = options.shouldTakeToken;\n        sync = options.sync;\n    } else if (typeof options === \"function\") {\n        task = options;\n        options = {};\n    }\n\n    if (typeof task !== \"function\") {\n        task = Function.prototype;\n    }\n\n    num = toInteger(num, true, 1);\n    priority = toInteger(priority, false, this.priority);\n\n    const item = {\n        id: ++globalCounter,\n        task,\n        priority,\n        num,\n        onTimeOut,\n        onCancel,\n        unfair,\n        shouldTakeToken,\n        sync,\n        semaphore: this,\n        taken: 0,\n        cancel: () => {\n            const taken = item.taken;\n            this._removeItem(item);\n\n            if (taken !== 0) {\n                // give on next tick to wait for all synchronous canceled to be done\n                this.setImmediateTick(() => {\n                    this.semGive(taken, true);\n                });\n            }\n\n            if (typeof onCancel === \"function\") {\n                onCancel();\n            }\n        },\n        setPriority: nextPriority => {\n            if (item.group == null) {\n                return;\n            }\n\n            nextPriority = toInteger(nextPriority, false, this.priority);\n            if (nextPriority === item.priority) {\n                return;\n            }\n\n            item.group.stack.remove(item);\n            if (item.group.stack.length === 0) {\n                // No more inWaiting for this priority group\n                item.semaphore._queue.remove(item.group);\n            }\n\n            item.priority = nextPriority;\n            this._addItemPriority(item);\n        }\n    };\n\n    this._addItemPriority(item);\n\n    if (isNumeric(timeOut) && timeOut > 0) {\n        item.timer = setTimeout(() => {\n            const taken = item.taken;\n            this._removeItem(item);\n\n            if (taken !== 0) {\n                // give on next tick to wait for all synchronous canceled to be done\n                this.setImmediateTick(() => {\n                    this.semGive(taken, true);\n                });\n            }\n\n            if (typeof onTimeOut === \"function\") {\n                onTimeOut();\n            }\n        }, timeOut);\n    }\n\n    const res = {\n        addCounter(nextNum) {\n            item.num += toInteger(nextNum, 1);\n        },\n\n        cancel() {\n            item.cancel();\n        },\n\n        setPriority(nextPriority) {\n            item.setPriority(nextPriority);\n        }\n    };\n\n    const hasResult = isObject(result);\n\n    if (hasResult) {\n        result.addCounter = res.addCounter;\n        result.cancel = res.cancel;\n        result.setPriority = res.setPriority;\n    }\n\n    item.disable = () => {\n        delete res.addCounter;\n        delete res.cancel;\n        delete res.setPriority;\n\n        if (hasResult) {\n            delete result.addCounter;\n            delete result.cancel;\n            delete result.setPriority;\n        }\n    };\n\n    this._semTake();\n    return res;\n};\n\nSemaphore.prototype._shouldTakeToken = function _shouldTakeToken(item, num) {\n    // avoid giving item as context when calling shouldTakeToken\n    return typeof item.shouldTakeToken !== \"function\" || (0, item.shouldTakeToken)(num, item.num, item.taken, this);\n};\n\nSemaphore.prototype._nextGroupItem = function _nextGroupItem() {\n    let groupIterator, group, itemIterator, item;\n\n    groupIterator = this._queue.beginIterator();\n    group = groupIterator.value();\n\n    itemIterator = group.stack.beginIterator();\n    item = itemIterator.value();\n\n    while (item && item.num !== 0 && !this._shouldTakeToken(item, Math.min(item.num, this._numTokens))) {\n        item = null;\n\n        itemIterator = itemIterator.next();\n        if (itemIterator === null) {\n            groupIterator = groupIterator.next();\n            if (groupIterator === null) {\n                break;\n            }\n\n            group = groupIterator.value();\n            itemIterator = group.stack.beginIterator();\n        }\n\n        item = itemIterator.value();\n    }\n\n    return [group, item];\n};\n\n/**\n * Take tokens if available\n *\n */\nSemaphore.prototype._semTake = function _semTake(topSync) {\n    if (this.taking) {\n        return;\n    }\n\n    if (typeof this.keepAlive === \"undefined\") {\n        this._keepAlive();\n    }\n\n    this.taking = true;\n    while (this._checkKeepAlive(this._destroyWaiting)) {\n        const [group, item] = this._nextGroupItem();\n        if (item == null) {\n            break;\n        }\n\n        let weakerIterator, wearkeGroup, weakerItemIterator, weakerItem;\n\n        // if item is still waiting for tokens\n        if (item.num > this._numTokens) {\n            item.taken += this._numTokens;\n            item.num -= this._numTokens;\n            this._numTokens = 0;\n\n            // take token from tasks with weaker priority\n            if (item.unfair && this._queue.length !== 1) {\n                weakerIterator = this._queue.endIterator().previous();\n\n                while (weakerIterator && item.num !== 0) {\n                    wearkeGroup = weakerIterator.value();\n                    if (wearkeGroup === group || wearkeGroup.priority <= this.priority) {\n                        // can only be unfair on tasks with lower priority that semaphore default priority\n                        break;\n                    }\n\n                    weakerItemIterator = wearkeGroup.stack.endIterator().previous();\n                    weakerItem = weakerItemIterator ? weakerItemIterator.value() : null;\n\n                    while (weakerItem && item.num !== 0) {\n                        if (weakerItem.taken > 0 && this._shouldTakeToken(item, Math.min(item.num, weakerItem.taken))) {\n                            if (item.num > weakerItem.taken) {\n                                weakerItem.num += weakerItem.taken;\n                                item.num -= weakerItem.taken;\n                                weakerItem.taken = 0;\n                            } else {\n                                weakerItem.taken -= item.num;\n                                weakerItem.num += item.num;\n                                item.num = 0;\n                            }\n                        }\n\n                        weakerItemIterator = weakerItemIterator.hasPrevious() && weakerItemIterator.previous();\n                        weakerItem = weakerItemIterator ? weakerItemIterator.value() : null;\n                    }\n\n                    weakerIterator = weakerIterator.hasPrevious() && weakerIterator.previous();\n                }\n            }\n\n            // if item is still waiting for tokens, try again at next give or flush\n            if (item.num !== 0) {\n                break;\n            }\n        }\n\n        item.taken += item.num;\n        if (this._numTokens !== Number.POSITIVE_INFINITY) {\n            this._numTokens -= item.num;\n        }\n        item.num = 0;\n\n        const sync = typeof topSync !== \"undefined\" ? topSync : typeof item.sync !== \"undefined\" ? item.sync : this.sync;\n        const {disable, taken, task} = item;\n        this._removeItem(item);\n\n        if (sync) {\n            disable();\n            task();\n        } else {\n            // Non blocking call of callback\n            // A way to loop through in waiting tasks without blocking\n            // the semaphore process until done\n            let timerID = this.setImmediateTick(() => {\n                timerID = null;\n                disable();\n                task();\n            });\n            item.cancel = () => {\n                this._clearImmediateTick(timerID);\n                disable();\n                timerID = null;\n\n                // give on next tick to wait for all synchronous canceled to be done\n                this.setImmediateTick(() => {\n                    this.semGive(taken, true);\n                });\n\n                const {onCancel} = item;\n                if (typeof onCancel === \"function\") {\n                    onCancel();\n                }\n            };\n        }\n    }\n    this.taking = false;\n};\n\n/**\n * Destroy all inwaiting tasks\n * @param  {Boolean} safe if true, wait for all inwaiting tasks to be performed, else, destroy with no warn\n */\nSemaphore.prototype.destroy = function(safe, onDestroy) {\n    if (this._destroying) {\n        return false;\n    }\n\n    this._destroying = true;\n    this.__onDestroy = onDestroy;\n\n    if (safe !== false) {\n        this._destroyWaiting = true;\n        this._semTake();\n        return true;\n    }\n\n    return this._destroy(safe);\n};\n\nSemaphore.prototype._destroy = function(safe) {\n    this._destroyWaiting = false;\n\n    // for loop to avoid infinite loop with while\n    for (let i = 0, _len = this._queue.length; i < _len; i++) {\n        const group = this._queue.beginIterator().value();\n        const item = group.stack.beginIterator().value();\n\n        if (safe !== false) {\n            item.cancel();\n        }\n        this._removeItem(item);\n    }\n\n    if (this._checkKeepAlive()) {\n        return false;\n    }\n\n    const __onDestroy = this.__onDestroy;\n\n    this.destroyed = true;\n    if (\"function\" === typeof __onDestroy) {\n        __onDestroy();\n    }\n    return true;\n};\n\nSemaphore.prototype.schedule = function(collection, priority, iteratee, callback) {\n    const semID = this;\n\n    switch (arguments.length) {\n        case 2:\n            if (typeof priority === \"function\") {\n                callback = priority;\n                priority = null;\n            }\n            break;\n        case 3:\n            callback = iteratee;\n            iteratee = null;\n\n            if (\"function\" === typeof priority) {\n                iteratee = priority;\n                priority = null;\n            }\n            break;\n        default:\n            // Nothing to do\n    }\n\n    if (callback == null) {\n        callback = Function.prototype;\n    }\n\n    let count = 0;\n    let index = -1;\n    const isArray = Array.isArray(collection);\n    const keys = isArray ? null : Object.keys(collection);\n    const len = isArray ? collection.length : keys.length;\n\n    if (len === 0) {\n        callback();\n        return null;\n    }\n\n    const items = new Array(len);\n    let doneCalled = false;\n    let canceled = false;\n    let taken = 0;\n    const errors = new Array(len);\n    let hasError = false;\n\n    const onTake = (coll, i) => {\n        taken++;\n        items[i] = null;\n        const key = isArray ? i : keys[i];\n\n        let called = false;\n        const next = err => {\n            if (called) {\n                throw new Error(\"callback already called\");\n            }\n            called = true;\n            items[i] = null;\n\n            semID.semGive();\n            taken--;\n\n            if (doneCalled) {\n                return;\n            }\n\n            if (canceled && !err) {\n                err = new Error(\"canceled\");\n                err.code = \"CANCELED\";\n            }\n\n            if (err) {\n                if (!hasError) {\n                    hasError = true;\n                    if (!canceled) {\n                        cancel();\n                    }\n                }\n                errors[i] = err;\n            }\n\n            if (++count === len || hasError && taken === 0) {\n                doneCalled = true;\n                if (canceled) {\n                    errors.code = \"CANCELED\";\n                }\n                callback(hasError ? errors : null);\n            }\n        };\n\n        if (canceled) {\n            next();\n            return;\n        }\n\n        const icancel = typeof iteratee === \"function\" ? iteratee(coll[key], key, next) : coll[key](next);\n\n        items[i] = {\n            cancel: () => {\n                if (typeof icancel === \"function\") {\n                    icancel();\n                } else if (icancel !== null && typeof icancel === \"object\") {\n                    if (typeof icancel.cancel === \"function\") {\n                        icancel.cancel();\n                    } else if (typeof icancel.abort === \"function\") {\n                        icancel.abort();\n                    }\n                }\n            }\n        };\n    };\n\n    const iterate = i => {\n        const item = semID.semTake({\n            priority,\n            onTake: onTake.bind(null, collection, i)\n        });\n\n        const proxy = {\n            cancel: item.cancel ? () => {\n                item.cancel();\n                onTake(collection, i);\n            }: undefined\n        };\n\n        for (const key in item) {\n            if (key === \"cancel\") {\n                continue;\n            }\n\n            Object.defineProperty(proxy, key, {\n                configurable: true,\n                enumerable: true,\n                get() {\n                    return item[key];\n                },\n                set(value) {\n                    item[key] = value;\n                    return value;\n                }\n            });\n        }\n\n        return proxy;\n    };\n\n    const loop = () => {\n        do {\n            ++index;\n            items[index] = iterate(index);\n        } while (index !== len - 1);\n    };\n\n    function cancel() {\n        if (canceled) {\n            return;\n        }\n\n        canceled = true;\n        for (let i = 0, size = items.length; i < size; i++) {\n            if (items[i] !== null && typeof items[i] === \"object\" && typeof items[i].cancel === \"function\") {\n                items[i].cancel();\n                items[i] = null;\n            }\n        }\n    }\n\n    const setPriority = nextPriority => {\n        for (let i = 0, size = items.length; i < size; i++) {\n            if (items[i] !== null && typeof items[i] === \"object\" && typeof items[i].setPriority === \"function\") {\n                items[i].setPriority(nextPriority);\n            }\n        }\n    };\n\n    loop();\n\n    return {\n        setPriority,\n        cancel\n    };\n};\n\nSemaphore.prototype._addItemPriority = function(item) {\n    let group = this._queue.get({\n        priority: item.priority\n    });\n    if (!group) {\n        group = this._addGroup(item);\n    }\n    group.stack.add(item);\n    item.group = group;\n};\n\nSemaphore.prototype._checkKeepAlive = function _checkKeepAlive(_destroyWaiting) {\n    if (this._hasInWaitingTask()) {\n        return true;\n    }\n\n    if (this.keepAlive) {\n        clearTimeout(this.keepAlive);\n        delete this.keepAlive;\n    }\n\n    if (_destroyWaiting) {\n        this._destroy();\n    }\n    return false;\n};\n\nSemaphore.prototype.isAlive = function isAlive() {\n    return Boolean(this.keepAlive);\n};\n\nSemaphore.prototype.hasInWaitingTask = function hasInWaitingTask() {\n    return hasProp.call(this, \"_queue\") && this._hasInWaitingTask();\n};\n\nSemaphore.prototype._countInWaitingTokens = function _countInWaitingTokens() {\n    let count = 0;\n\n    if (!this.hasInWaitingTask()) {\n        return count;\n    }\n\n    let iterator = this._queue.beginIterator();\n\n    let group, itemerator, item;\n    while (iterator) {\n        group = iterator.value();\n\n        if (group != null && group.stack.length !== 0) {\n            itemerator = group.stack.beginIterator();\n\n            while (itemerator) {\n                item = itemerator.value();\n                if (item != null) {\n                    count += item.num;\n                }\n                itemerator = itemerator.hasNext() && itemerator.next();\n            }\n        }\n\n        iterator = iterator.hasNext() && iterator.next();\n    }\n\n    return count;\n};\n\nSemaphore.prototype._hasInWaitingTask = function _hasInWaitingTask() {\n    return this._queue.length !== 0;\n};\n\nSemaphore.prototype._keepAlive = function _keepAlive() {\n    if (!this._hasInWaitingTask()) {\n        return;\n    }\n    const _this = this;\n    this.keepAlive = setTimeout(() => {\n        _this._keepAlive();\n    }, 1000);\n};\n\n/**\n * Remove item from a priority group\n *\n */\nSemaphore.prototype._removeItem = function _removeItem(item) {\n    if (item.timer) {\n        clearTimeout(item.timer);\n    }\n\n    item.group.stack.remove(item);\n    if (item.group.stack.length === 0) {\n        // No more inWaiting for this priority group\n        item.semaphore._queue.remove(item.group);\n\n        item.semaphore._checkKeepAlive();\n    }\n\n    // Remove properties to allow garbage collector\n    // eslint-disable-next-line guard-for-in\n    for (const property in item) {\n        if (property !== \"id\") {\n            delete item[property];\n        }\n    }\n};\n\nSemaphore.prototype._addGroup = function _addGroup(item) {\n    const stack = new SortedSet({\n        comparator: idComparator\n    });\n\n    const group = {\n        priority: item.priority,\n        stack\n    };\n    item.semaphore._queue.add(group);\n    return group;\n};\n\nfunction idComparator(a, b) {\n    return a.id > b.id ? 1 : a.id < b.id ? -1 : 0;\n}\n\nfunction priorityComparator(a, b) {\n    return a.priority > b.priority ? 1 : a.priority < b.priority ? -1 : 0;\n}\n\nexports.semCreate = function() {\n    const semID = Object.create(Semaphore.prototype);\n    Semaphore.apply(semID, arguments);\n    return semID;\n};\n\n// Allow customization/Patch fix from outside\nexports.Semaphore = Semaphore;\n\n\n\n// WEBPACK FOOTER //\n// ./lib/sem-lib.js","var g;\r\n\r\n// This works in non-strict mode\r\ng = (function() {\r\n\treturn this;\r\n})();\r\n\r\ntry {\r\n\t// This works if eval is allowed (see CSP)\r\n\tg = g || Function(\"return this\")() || (1,eval)(\"this\");\r\n} catch(e) {\r\n\t// This works if the window reference is available\r\n\tif(typeof window === \"object\")\r\n\t\tg = window;\r\n}\r\n\r\n// g can still be undefined, but nothing to do about it...\r\n// We return undefined, instead of nothing here, so it's\r\n// easier to handle this case. if(!global) { ...}\r\n\r\nmodule.exports = g;\r\n\n\n\n// WEBPACK FOOTER //\n// (webpack)/buildin/global.js","module.exports = class AbstractSortedSet\n  constructor: (options) ->\n    throw 'Must pass options.strategy, a strategy' if !options?.strategy?\n    throw 'Must pass options.comparator, a comparator' if !options?.comparator?\n    @priv = new options.strategy(options)\n    @length = 0\n\n  insert: (value) ->\n    @priv.insert(value)\n    @length += 1\n    this\n\n  remove: (value) ->\n    @priv.remove(value)\n    @length -= 1\n    this\n\n  contains: (value) ->\n    @priv.contains(value)\n\n  # Returns this set as an Array\n  toArray: -> @priv.toArray()\n\n  forEach: (callback, thisArg) ->\n    @priv.forEachImpl(callback, this, thisArg)\n    this\n\n  map: (callback, thisArg) ->\n    ret = []\n    @forEach (value, index, self) ->\n      ret.push(callback.call(thisArg, value, index, self))\n    ret\n\n  filter: (callback, thisArg) ->\n    ret = []\n    @forEach (value, index, self) ->\n      ret.push(value) if callback.call(thisArg, value, index, self)\n    ret\n\n  every: (callback, thisArg) ->\n    ret = true\n    @forEach (value, index, self) ->\n      ret = false if ret && !callback.call(thisArg, value, index, self)\n    ret\n\n  some: (callback, thisArg) ->\n    ret = false\n    @forEach (value, index, self) ->\n      ret = true if !ret && callback.call(thisArg, value, index, self)\n    ret\n\n  # An iterator is similar to a C++ iterator: it points _before_ a value.\n  #\n  # So in this sorted set:\n  #\n  #   | 1 | 2 | 3 | 4 | 5 |\n  #   ^a      ^b          ^c\n  #\n  # `a` is a pointer to the beginning of the iterator. `a.value()` returns\n  # `3`. `a.previous()` returns `null`. `a.setValue()` works, if\n  # `options.allowSetValue` is true.\n  # \n  # `b` is a pointer to the value `3`. `a.previous()` and `a.next()` both do\n  # the obvious.\n  #\n  # `c` is a pointer to the `null` value. `c.previous()` works; `c.next()`\n  # returns null. `c.setValue()` throws an exception, even if\n  # `options.allowSetValue` is true.\n  #\n  # Iterators have `hasNext()` and `hasPrevious()` methods, too.\n  #\n  # Iterators are immutible. `iterator.next()` returns a new iterator.\n  #\n  # Iterators become invalid as soon as `insert()` or `remove()` is called.\n  findIterator: (value) ->\n    @priv.findIterator(value)\n\n  # Finds an iterator pointing to the lowest possible value.\n  beginIterator: ->\n    @priv.beginIterator()\n\n  # Finds an iterator pointing to the `null` value.\n  endIterator: ->\n    @priv.endIterator()\n\n\n\n// WEBPACK FOOTER //\n// ./node_modules/js-sorted-set/src/SortedSet/AbstractSortedSet.coffee","AbstractBinaryTreeStrategy = require('./AbstractBinaryTreeStrategy')\n\n# An implementation of Left-Leaning Red-Black trees.\n#\n# It's copied from http://www.cs.princeton.edu/~rs/talks/LLRB/LLRB.pdf.\n# It's practically a copy-paste job, minus the semicolons. missing bits were\n# filled in with hints from\n# http://www.teachsolaisgames.com/articles/balanced_left_leaning.html\n#\n# Here are some differences:\n# * This isn't a map structure: it's just a tree. There are no keys: the\n#   comparator applies to the values.\n# * We use the passed comparator.\n\nclass Node\n  constructor: (@value) ->\n    @left = null\n    @right = null\n    @isRed = true # null nodes -- leaves -- are black\n\nrotateLeft = (h) ->\n  x = h.right\n  h.right = x.left\n  x.left = h\n  x.isRed = h.isRed\n  h.isRed = true\n  x\n\nrotateRight = (h) ->\n  x = h.left\n  h.left = x.right\n  x.right = h\n  x.isRed = h.isRed\n  h.isRed = true\n  x\n\ncolorFlip = (h) ->\n  h.isRed = !h.isRed\n  h.left.isRed = !h.left.isRed\n  h.right.isRed = !h.right.isRed\n  undefined\n\nmoveRedLeft = (h) ->\n  #throw 'Preconditions failed' if !(!h.left.isRed && !h.left.left?.isRed)\n  colorFlip(h)\n  if h.right isnt null && h.right.left isnt null && h.right.left.isRed\n    h.right = rotateRight(h.right)\n    h = rotateLeft(h)\n    colorFlip(h)\n  h\n\nmoveRedRight = (h) ->\n  #throw 'Preconditions failed' if !(!h.right.isRed && !h.right.left?.isRed)\n  colorFlip(h)\n  if h.left isnt null && h.left.left isnt null && h.left.left.isRed\n    h = rotateRight(h)\n    colorFlip(h)\n  h\n\ninsertInNode = (h, value, compare) ->\n  if h is null\n    return new Node(value)\n\n  #if h.left isnt null && h.left.isRed && h.right isnt null && h.right.isRed\n  #  colorFlip(h)\n\n  if h.value is value\n    throw 'Value already in set'\n  else\n    if compare(value, h.value) < 0\n      h.left = insertInNode(h.left, value, compare)\n    else\n      h.right = insertInNode(h.right, value, compare)\n\n  if h.right isnt null && h.right.isRed && !(h.left isnt null && h.left.isRed)\n    h = rotateLeft(h)\n\n  if h.left isnt null && h.left.isRed && h.left.left isnt null && h.left.left.isRed\n    h = rotateRight(h)\n\n  # Put this here -- I couldn't get the whole thing to work otherwise :(\n  if h.left isnt null && h.left.isRed && h.right isnt null && h.right.isRed\n    colorFlip(h)\n\n  h\n\nfindMinNode = (h) ->\n  while h.left isnt null\n    h = h.left\n  h\n\nfixUp = (h) ->\n  # Fix right-leaning red nodes\n  if h.right isnt null && h.right.isRed\n    h = rotateLeft(h)\n\n  # Handle a 4-node that traverses down the left\n  if h.left isnt null && h.left.isRed && h.left.left isnt null && h.left.left.isRed\n    h = rotateRight(h)\n\n  # split 4-nodes\n  if h.left isnt null && h.left.isRed && h.right isnt null && h.right.isRed\n    colorFlip(h)\n\n  h\n\nremoveMinNode = (h) ->\n  if h.left is null\n    return null\n\n  if !h.left.isRed && !(h.left.left isnt null && h.left.left.isRed)\n    h = moveRedLeft(h)\n\n  h.left = removeMinNode(h.left)\n\n  fixUp(h)\n\nremoveFromNode = (h, value, compare) ->\n  throw 'Value not in set' if h is null\n\n  if h.value isnt value && compare(value, h.value) < 0\n    throw 'Value not in set' if h.left is null\n    if !h.left.isRed && !(h.left.left isnt null && h.left.left.isRed)\n      h = moveRedLeft(h)\n    h.left = removeFromNode(h.left, value, compare)\n  else\n    if h.left isnt null && h.left.isRed\n      h = rotateRight(h)\n\n    if h.right is null\n      if value is h.value\n        return null # leaf node; LLRB assures no left value here\n      else\n        throw 'Value not in set'\n\n    if !h.right.isRed && !(h.right.left isnt null && h.right.left.isRed)\n      h = moveRedRight(h)\n    if value is h.value\n      h.value = findMinNode(h.right).value\n      h.right = removeMinNode(h.right)\n    else\n      h.right = removeFromNode(h.right, value, compare)\n\n  h = fixUp(h) if h isnt null\n\n  h\n\nmodule.exports = class RedBlackTreeStrategy extends AbstractBinaryTreeStrategy\n  constructor: (@options) ->\n    @comparator = @options.comparator\n    @root = null\n\n  insert: (value) ->\n    @root = insertInNode(@root, value, @comparator)\n    @root.isRed = false # always\n    undefined\n\n  remove: (value) ->\n    @root = removeFromNode(@root, value, @comparator)\n    @root.isRed = false if @root isnt null\n    undefined\n\n\n\n// WEBPACK FOOTER //\n// ./node_modules/js-sorted-set/src/SortedSet/RedBlackTreeStrategy.coffee","BinaryTreeIterator = require('./BinaryTreeIterator')\n\nbinaryTreeTraverse = (node, callback) ->\n  if node isnt null\n    binaryTreeTraverse(node.left, callback)\n    callback(node.value)\n    binaryTreeTraverse(node.right, callback)\n  undefined\n\n# An AbstractBinaryTree has a @root. @root is null or an object with\n# `.left`, `.right` and `.value` properties.\nclass AbstractBinaryTree\n  toArray: ->\n    ret = []\n    binaryTreeTraverse(@root, (value) -> ret.push(value))\n    ret\n\n  forEachImpl: (callback, sortedSet, thisArg) ->\n    i = 0\n    binaryTreeTraverse @root, (value) ->\n      callback.call(thisArg, value, i, sortedSet)\n      i += 1\n    undefined\n\n  contains: (value) ->\n    comparator = @comparator\n\n    node = @root\n    while node isnt null\n      cmp = comparator(value, node.value)\n      if cmp == 0\n        break\n      else if cmp < 0\n        node = node.left\n      else\n        node = node.right\n\n    node isnt null && node.value == value\n\n  findIterator: (value) -> BinaryTreeIterator.find(this, value, @comparator)\n  beginIterator: -> BinaryTreeIterator.left(this)\n  endIterator: -> BinaryTreeIterator.right(this)\n\nmodule.exports = AbstractBinaryTree\n\n\n\n// WEBPACK FOOTER //\n// ./node_modules/js-sorted-set/src/SortedSet/AbstractBinaryTreeStrategy.coffee","descendAllTheWay = (leftOrRight, node) ->\n  # Assumes node._iteratorParentNode is set\n  while node[leftOrRight] isnt null\n    parent = node\n    node = node[leftOrRight]\n    node._iteratorParentNode = parent\n  node\n\nmoveCursor = (leftOrRight, node) ->\n  if node[leftOrRight] isnt null\n    parent = node\n    node = node[leftOrRight]\n    node._iteratorParentNode = parent\n    rightOrLeft = if leftOrRight == 'left' then 'right' else 'left'\n    node = descendAllTheWay(rightOrLeft, node)\n  else\n    while (parent = node._iteratorParentNode) isnt null && parent[leftOrRight] is node\n      node = parent\n    node = parent # either null or the correct-direction parent\n\n  node\n\n# The BinaryTreeIterator actually writes to the tree: it maintains a\n# \"_iteratorParentNode\" variable on each node. Please ignore this.\nclass BinaryTreeIterator\n  constructor: (@tree, @node) ->\n\n  next: ->\n    if @node is null\n      null\n    else\n      node = moveCursor('right', @node)\n      new BinaryTreeIterator(@tree, node)\n\n  previous: ->\n    if @node is null\n      if @tree.root is null\n        null\n      else\n        @tree.root._iteratorParentNode = null\n        node = descendAllTheWay('right', @tree.root)\n        new BinaryTreeIterator(@tree, node)\n    else\n      node = moveCursor('left', @node)\n      if node is null\n        null\n      else\n        new BinaryTreeIterator(@tree, node)\n\n  hasNext: -> @node isnt null\n  hasPrevious: -> @previous() isnt null\n  value: -> if @node is null then null else @node.value\n  setValue: (value) ->\n    throw 'Must set options.allowSetValue' if !@tree.options.allowSetValue\n    throw 'Cannot set value at end of set' if !@hasNext()\n    @node.value = value\n\nBinaryTreeIterator.find = (tree, value, comparator) ->\n  root = tree.root\n  root?._iteratorParentNode = null\n  node = root\n  nextNode = null # For finding an in-between node\n  while node isnt null\n    cmp = comparator(value, node.value)\n    if cmp == 0\n      break\n    else if cmp < 0\n      break if node.left is null\n\n      nextNode = node # If we descend all right after this until there are\n                      # no more right nodes, we want to return an\n                      # \"in-between\" iterator ... pointing here.\n      node.left._iteratorParentNode = node\n      node = node.left\n    else\n      if node.right isnt null\n        node.right._iteratorParentNode = node\n        node = node.right\n      else\n        node = nextNode\n        break\n\n  return new BinaryTreeIterator(tree, node)\n\nBinaryTreeIterator.left = (tree) ->\n  if tree.root is null\n    new BinaryTreeIterator(tree, null)\n  else\n    tree.root._iteratorParentNode = null\n    node = descendAllTheWay('left', tree.root)\n    new BinaryTreeIterator(tree, node)\n\nBinaryTreeIterator.right = (tree) ->\n  new BinaryTreeIterator(tree, null)\n\nmodule.exports = BinaryTreeIterator\n\n\n\n// WEBPACK FOOTER //\n// ./node_modules/js-sorted-set/src/SortedSet/BinaryTreeIterator.coffee"],"sourceRoot":""}